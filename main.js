!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class t{constructor(e){this._modalElement=document.querySelector(e),this._modalCloseButton=this._modalElement.querySelector(".modal__close")}open(){this._modalElement.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()})),this._modalCloseButton.addEventListener("click",(e=>{this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._formInputs=this._modalElement.querySelectorAll(".modal__input"),this._formElement=this._modalElement.querySelector(".modal__form"),this._submitBtn=this._modalElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._formElement.reset()}showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){this._formElement.addEventListener("submit",(()=>{console.log(this._getInputValues()),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}class r{constructor(e,t,s,r,n){this._isLiked=e.isLiked,this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteBtn=r,this._handleLikes=n}_setEventListeners(){this._cardElement.querySelector(".card__heart-button").addEventListener("click",(()=>{this._handleLikes(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteBtn(this))),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this)}))}getId(){const e=this._id;return console.log(e),e}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._cardElement.querySelector(".card__heart-button").classList.add("card__heart-button_active"):this._cardElement.querySelector(".card__heart-button").classList.remove("card__heart-button_active")}getCardEl(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return this._renderLikes(),t.textContent=this._name,e.setAttribute("alt",this._name),e.setAttribute("src",this._link),this._setEventListeners(),this._cardElement}}class n{constructor(e,t){this._formEl=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formInputs=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._buttonEl=this._formEl.querySelector(this._submitButtonSelector)}_showErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this.errorClass)}_hideErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_disableButton(){this._buttonEl.classList.add(this._inactiveButtonClass),this._buttonEl.setAttribute("disabled","")}_enableButton(){this._buttonEl.classList.remove(this._inactiveButtonClass),this._buttonEl.removeAttribute("disabled")}_hasInvalidInputs(){return this._formInputs.some((e=>!e.validity.valid||!e.value))}_checkInputValidity(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}resetModalValidity(){this._disableButton(),this._formInputs.forEach((e=>{this._hideErrorMessage(e)}))}toggleButtonState(){this._hasInvalidInputs(this._formInputs)?this._disableButton():this._enableButton()}_setEventListeners(){this.toggleButtonState(),this._formInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},o=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),l=document.querySelector(".profile__title"),d=document.querySelector(".profile__description"),c=document.querySelector("#edit_modal-input-name"),h=document.querySelector("#edit-modal-input-desc"),_=a.querySelector(".modal__form"),u=document.querySelector(".profile__image"),m=document.querySelector(".profile__image_edit-button"),E=document.querySelector(".cards__list"),p=document.querySelector("#card-add-modal"),v=document.querySelector("#card-add-button"),f=p.querySelector(".modal__form"),L=document.querySelector("#update-avatar-modal").querySelector(".modal__form"),b=new class{constructor(e,t,s){this._nameElement=e,this._aboutElement=t,this._avatar=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.about=this._aboutElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._aboutElement.textContent=t}setUserAvatar(e){this._avatar.src=e}}(l,d,u),S=new s("#profile-edit-modal",(function(e){S.showLoading(!0),B.updateUserInfo(e).then((e=>{b.setUserInfo(e.name,e.about),S.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{S.showLoading(!1)}),1e3)}))})),y=new s("#update-avatar-modal",(function(e){y.showLoading(!0),B.updateUserAvatar(e).then((e=>{y.close(),b.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{y.showLoading(!1)}),1e3)}))})),g=new s("#card-add-modal",(function(e){g.showLoading(!0);const{title:t,url:s}=e,r={name:t,link:s};B.addNewCard(r).then((e=>{const t=x(e);$.addItem(t),g.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{g.showLoading(!1)}),1e3)}))})),C=new class extends t{constructor(e){super(e),this._prevImageCaption=this._modalElement.querySelector(".modal__preview-image-caption"),this._prevModalImage=this._modalElement.querySelector(".modal__prev-image")}open(e){this._prevModalImage.src=e._link,this._prevModalImage.alt=e._name,this._prevImageCaption.textContent=e._name,super.open()}}("#image-preview-modal"),k=new class extends t{constructor(e){super(e),this._formElement=this._modalElement.querySelector(".modal__form"),this._submitBtn=this._modalElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}setSubmitAction(e){this._handleformSubmit=e}showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleformSubmit()})),super.setEventListeners()}}("#card-delete-confirm-modal"),I=new n(i,_),q=new n(i,f),w=new n(i,L),B=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}intialSetup(e){return Promise.all(e)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}updateUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e4d91a75-4cb0-43d1-85cd-37dfda4c3b7e","Content-Type":"application/json"}});let $;function x(e){const t=new r(e,"#card-template",A,(function(e){k.open(),k.showLoading(!0),k.setSubmitAction((()=>{B.deleteCard(e.getId()).then((()=>{k.close(),e.handleDeleteCard()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{k.showLoading(!1)}),1e3)}))}))}),(function(e){t.isLiked()?B.removeCardLike(e.getId()).then((e=>{t.setIsLiked(e._isLiked)})).catch((e=>{console.error(`Error ${e}`)})):B.addCardLike(e.getId()).then((e=>{t.setIsLiked(!e._isLiked)})).catch((e=>{console.error(`Error ${e}`)}))}));return t.getCardEl()}function A(e){C.open(e)}B.intialSetup([void B.getInitialCards().then((t=>{$=new e({items:t,renderer:e=>{const t=x(e);$.addItem(t)}},E),$.renderItems()})).catch((e=>{console.error(`Error ${e}`)})),void B.loadUserInfo().then((e=>{b.setUserInfo(e.name,e.about),b.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)}))]),I.enableValidation(),q.enableValidation(),w.enableValidation(),y.setEventListeners(),S.setEventListeners(),g.setEventListeners(),C.setEventListeners(),k.setEventListeners(),o.addEventListener("click",(()=>{I.resetModalValidity(),c.value=l.textContent,h.value=d.textContent,S.open()})),m.addEventListener("click",(e=>{e.preventDefault(),w.resetModalValidity(),y.open()})),v.addEventListener("click",(e=>{e.preventDefault(),q.resetModalValidity(),g.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q054RyxRQUFReUcsTUFBTyxTQUFRRCxJQUFNLE1BcUVuQ3NCLEVBQWtCL0QsbUJBRWxCZ0UsRUFBaUJoRSxtQkFFakJpRSxFQUFzQmpFLG1CQUV0QjZDLEVBQWtCdEksb0JBRWxCMkgsRUFBYzNILG9CQUVkeUksRUFBYXpJLG9CQUViZ0osRUFBZWhKLG9CQUVmb0osRUFBZ0JwSixvQkFJaEI2RixFQUFZcEcsaUJBQWlCLFNBQVMsS0FDcEMrSixFQUFrQmpFLHFCQUNsQlUsRUFBa0IvRSxNQUFRNkUsRUFBVWxGLFlBQ3BDcUYsRUFBa0JoRixNQUFROEUsRUFBU25GLFlBQ25DOEcsRUFBY3JJLE1BQU0sSUFHdEIrRyxFQUFrQjVHLGlCQUFpQixTQUFVUSxJQUMzQ0EsRUFBRXlGLGlCQUNGZ0UsRUFBc0JuRSxxQkFDdEIrQyxFQUFrQmhKLE1BQU0sSUFJMUJrSCxFQUFXL0csaUJBQWlCLFNBQVVRLElBQ3BDQSxFQUFFeUYsaUJBQ0YrRCxFQUFpQmxFLHFCQUNqQmtELEVBQWFuSixNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBpdGVtQ29udGFpbmVyRWwpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gaXRlbUNvbnRhaW5lckVsO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgLy8gdGhpcy5fbW9kYWxTZWxlY3RvciA9IG1vZGFsU2VsZWN0b3I7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9tb2RhbENsb3NlQnV0dG9uID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9fb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZSkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbFwiKSB8fFxuICAgICAgICBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgdGhpcy5fbW9kYWxDbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5fc3VibWl0QnRuID0gdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdG5UZXh0ID0gdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50O1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XG4gIH1cblxuICBzaG93TG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdG5UZXh0O1xuICAgIH1cbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2codGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ0bixcbiAgICBoYW5kbGVMaWtlc1xuICApIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdG4gPSBoYW5kbGVEZWxldGVCdG47XG4gICAgdGhpcy5faGFuZGxlTGlrZXMgPSBoYW5kbGVMaWtlcztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvL2NhcmQgXCJsaWtlXCIgYnV0dG9uXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0LWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VzKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICAvL2NhcmQgXCJkZWxldGVcIiBidXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVCdG4odGhpcykpO1xuXG4gICAgLy9wcmV2IGltYWdlIGNsaWNrXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgY29uc3QgaWQgPSB0aGlzLl9pZDtcbiAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgcmV0dXJuIGlkO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgfVxuXG4gIF9yZW5kZXJMaWtlcygpIHtcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpXG4gICAgICAgIC5jbGFzc0xpc3QuYWRkKFwiY2FyZF9faGVhcnQtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpXG4gICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKFwiY2FyZF9faGVhcnQtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG4gIH1cblxuICBnZXRDYXJkRWwoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuICAgIGNvbnN0IGNhcmRJbWFnZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pbWFnZVwiKTtcbiAgICBjb25zdCBjYXJkVGl0bGVFbCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fcmVuZGVyTGlrZXMoKTtcbiAgICBjYXJkVGl0bGVFbC50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG4gICAgY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwiYWx0XCIsIHRoaXMuX25hbWUpO1xuICAgIGNhcmRJbWFnZUVsLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9saW5rKTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gIGNvbnN0cnVjdG9yKHZhbGlkYXRpb25TZXR0aW5ncywgZm9ybUVsKSB7XG4gICAgdGhpcy5fZm9ybUVsID0gZm9ybUVsO1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmVycm9yQ2xhc3M7XG5cbiAgICB0aGlzLl9mb3JtSW5wdXRzID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXG4gICAgKTtcblxuICAgIHRoaXMuX2J1dHRvbkVsID0gdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuICB9XG5cbiAgX3Nob3dFcnJvck1lc3NhZ2UoZm9ybUlucHV0KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7Zm9ybUlucHV0LmlkfS1lcnJvcmApO1xuICAgIGZvcm1JbnB1dC5jbGFzc0xpc3QuYWRkKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBmb3JtSW5wdXQudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLmVycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVFcnJvck1lc3NhZ2UoZm9ybUlucHV0KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3RvcihgIyR7Zm9ybUlucHV0LmlkfS1lcnJvcmApO1xuICAgIGZvcm1JbnB1dC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsLnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIFwiXCIpO1xuICB9XG5cbiAgX2VuYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9idXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX2J1dHRvbkVsLnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICB9XG5cbiAgX2hhc0ludmFsaWRJbnB1dHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2Zvcm1JbnB1dHMuc29tZSgoZm9ybUlucHV0KSA9PiB7XG4gICAgICByZXR1cm4gIWZvcm1JbnB1dC52YWxpZGl0eS52YWxpZCB8fCAhZm9ybUlucHV0LnZhbHVlO1xuICAgIH0pO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShmb3JtSW5wdXQpIHtcbiAgICBpZiAoIWZvcm1JbnB1dC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0Vycm9yTWVzc2FnZShmb3JtSW5wdXQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfVxuICB9XG5cbiAgcmVzZXRNb2RhbFZhbGlkaXR5KCkge1xuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGZvcm1JbnB1dCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUVycm9yTWVzc2FnZShmb3JtSW5wdXQpO1xuICAgIH0pO1xuICB9XG5cbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dHModGhpcy5fZm9ybUlucHV0cykpIHtcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fZW5hYmxlQnV0dG9uKCk7XG4gICAgfVxuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGZvcm1JbnB1dCkgPT4ge1xuICAgICAgZm9ybUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShmb3JtSW5wdXQpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuXG5leHBvcnQgY29uc3QgY29uZmlnID0ge1xuICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciwgY29uZmlnIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgVmFyaWFibGVzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBjb25zdCBjbCA9IGNvbnNvbGUubG9nLmJpbmQoY29uc29sZSk7XG5cbmNvbnN0IHByb2ZFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZkVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuY29uc3QgcHJvZlRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmNvbnN0IHByb2ZEZXNjID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcbmNvbnN0IHByb2ZFZGl0TmFtZUlucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0X21vZGFsLWlucHV0LW5hbWVcIik7XG5jb25zdCBwcm9mRWRpdERlc2NJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZWRpdC1tb2RhbC1pbnB1dC1kZXNjXCIpO1xuY29uc3QgcHJvZkVkaXRGb3JtID0gcHJvZkVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgcHJvZkltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbmNvbnN0IHByb2ZBdmF0YXJFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZV9lZGl0LWJ1dHRvblwiKTtcblxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZEFkZEZvcm0gPSBjYXJkQWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuY29uc3QgdXBkYXRlQXZhdGFyTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3VwZGF0ZS1hdmF0YXItbW9kYWxcIik7XG5jb25zdCB1cGRhdGVBdmF0YXJGb3JtID0gdXBkYXRlQXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3MgSW5zdGFuY2VzICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHByb2ZUaXRsZSwgcHJvZkRlc2MsIHByb2ZJbWFnZSk7XG5cbmNvbnN0IGVkaXRQcm9mTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZVByb2ZJbmZvVXBkYXRlXG4pO1xuXG5jb25zdCBhdmF0YXJVcGRhdGVNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIsXG4gIGhhbmRsZUF2YXRhclVwZGF0ZVxuKTtcblxuY29uc3QgYWRkQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjY2FyZC1hZGQtbW9kYWxcIiwgaGFuZGxlQWRkQ2FyZFN1Ym1pdCk7XG5cbmNvbnN0IHByZXZJbWFnZU1vZGFsID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI2ltYWdlLXByZXZpZXctbW9kYWxcIik7XG5cbmNvbnN0IGRlbGV0ZUNhcmRNb2RhbCA9IG5ldyBQb3B1cFdpdGhEZWxldGUoXCIjY2FyZC1kZWxldGUtY29uZmlybS1tb2RhbFwiKTtcblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHByb2ZFZGl0Rm9ybSk7XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIGNhcmRBZGRGb3JtKTtcblxuY29uc3QgYXZhdGFyVXBkYXRlVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCB1cGRhdGVBdmF0YXJGb3JtKTtcblxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiZTRkOTFhNzUtNGNiMC00M2QxLTg1Y2QtMzdkZmRhNGMzYjdlXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQSSBDYWxscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5sZXQgc2VjdGlvbjtcblxuYXBpLmludGlhbFNldHVwKFtnZXRJbml0YWxDYXJkcygpLCBnZXRJbml0aWFsSW5mbygpXSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdW5jdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgZnVuY3Rpb24gaGFuZGxlRGVsQnRuKGNhcmRJbnN0YW5jZSkge1xuICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcbiAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zaG93TG9hZGluZyh0cnVlKTtcbiAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuZGVsZXRlQ2FyZChjYXJkSW5zdGFuY2UuZ2V0SWQoKSlcbiAgICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgICBkZWxldGVDYXJkTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgIGNhcmRJbnN0YW5jZS5oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgICAgIH0sIDEwMDApO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBmdW5jdGlvbiBoYW5kbGVMaWtlcyhjYXJkSW5zdGFuY2UpIHtcbiAgICAgIGlmIChjYXJkLmlzTGlrZWQoKSkge1xuICAgICAgICBhcGlcbiAgICAgICAgICAucmVtb3ZlQ2FyZExpa2UoY2FyZEluc3RhbmNlLmdldElkKCkpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC5zZXRJc0xpa2VkKHJlcy5faXNMaWtlZCk7XG4gICAgICAgICAgfSlcbiAgICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhcGlcbiAgICAgICAgICAuYWRkQ2FyZExpa2UoY2FyZEluc3RhbmNlLmdldElkKCkpXG4gICAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgICAgY2FyZC5zZXRJc0xpa2VkKCFyZXMuX2lzTGlrZWQpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0Q2FyZEVsKCk7XG59XG5cbmZ1bmN0aW9uIGdldEluaXRhbENhcmRzKCkge1xuICBhcGlcbiAgICAuZ2V0SW5pdGlhbENhcmRzKClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBzZWN0aW9uID0gbmV3IFNlY3Rpb24oXG4gICAgICAgIHtcbiAgICAgICAgICBpdGVtczogcmVzLFxuICAgICAgICAgIHJlbmRlcmVyOiAoY2FyZERhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XG4gICAgICAgICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIGNhcmRMaXN0RWxcbiAgICAgICk7XG4gICAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGdldEluaXRpYWxJbmZvKCkge1xuICBhcGlcbiAgICAubG9hZFVzZXJJbmZvKClcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcbiAgcHJldkltYWdlTW9kYWwub3BlbihjYXJkRGF0YSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZJbmZvVXBkYXRlKHByb2ZpbGVEYXRhKSB7XG4gIGVkaXRQcm9mTW9kYWwuc2hvd0xvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyhwcm9maWxlRGF0YSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcbiAgICAgIGVkaXRQcm9mTW9kYWwuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBlZGl0UHJvZk1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJVcGRhdGUoaW5wdXRWYWx1ZSkge1xuICBhdmF0YXJVcGRhdGVNb2RhbC5zaG93TG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJBdmF0YXIoaW5wdXRWYWx1ZSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBhdmF0YXJVcGRhdGVNb2RhbC5jbG9zZSgpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBhdmF0YXJVcGRhdGVNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZFN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBhZGRDYXJkTW9kYWwuc2hvd0xvYWRpbmcodHJ1ZSk7XG4gIGNvbnN0IHsgdGl0bGUsIHVybCB9ID0gaW5wdXRWYWx1ZXM7XG4gIGNvbnN0IGNhcmREYXRhID0geyBuYW1lOiB0aXRsZSwgbGluazogdXJsIH07XG4gIGFwaVxuICAgIC5hZGROZXdDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgICAgYWRkQ2FyZE1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgYWRkQ2FyZE1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH0pO1xufVxuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRnVuY3Rpb24gQ2FsbHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmF2YXRhclVwZGF0ZVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmF2YXRhclVwZGF0ZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmVkaXRQcm9mTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuYWRkQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbnByZXZJbWFnZU1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmRlbGV0ZUNhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBQcm9maWxlIEJ1dHRvbiBMaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5wcm9mRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldE1vZGFsVmFsaWRpdHkoKTtcbiAgcHJvZkVkaXROYW1lSW5wdXQudmFsdWUgPSBwcm9mVGl0bGUudGV4dENvbnRlbnQ7XG4gIHByb2ZFZGl0RGVzY0lucHV0LnZhbHVlID0gcHJvZkRlc2MudGV4dENvbnRlbnQ7XG4gIGVkaXRQcm9mTW9kYWwub3BlbigpO1xufSk7XG5cbnByb2ZBdmF0YXJFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGF2YXRhclVwZGF0ZVZhbGlkYXRvci5yZXNldE1vZGFsVmFsaWRpdHkoKTtcbiAgYXZhdGFyVXBkYXRlTW9kYWwub3BlbigpO1xufSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIENhcmQgQnV0dG9uIExpc3RlbmVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5jYXJkQWRkQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGFkZEZvcm1WYWxpZGF0b3IucmVzZXRNb2RhbFZhbGlkaXR5KCk7XG4gIGFkZENhcmRNb2RhbC5vcGVuKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IobmFtZUVsZW1lbnQsIGFib3V0RWxlbWVudCwgYXZhdGFyKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBuYW1lRWxlbWVudDtcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQgPSBhYm91dEVsZW1lbnQ7XG4gICAgdGhpcy5fYXZhdGFyID0gYXZhdGFyO1xuICB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgY29uc3QgdmFsdWVzID0ge307XG4gICAgdmFsdWVzLm5hbWUgPSB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudDtcbiAgICB2YWx1ZXMuYWJvdXQgPSB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgcmV0dXJuIHZhbHVlcztcbiAgfVxuXG4gIHNldFVzZXJJbmZvKHRpdGxlRGF0YSwgZGVzY0RhdGEpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRpdGxlRGF0YTtcbiAgICB0aGlzLl9hYm91dEVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjRGF0YTtcbiAgfVxuXG4gIHNldFVzZXJBdmF0YXIodXJsKSB7XG4gICAgdGhpcy5fYXZhdGFyLnNyYyA9IHVybDtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fcHJldkltYWdlQ2FwdGlvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2UtY2FwdGlvblwiXG4gICAgKTtcbiAgICB0aGlzLl9wcmV2TW9kYWxJbWFnZSA9XG4gICAgICB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldi1pbWFnZVwiKTtcbiAgfVxuXG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX3ByZXZNb2RhbEltYWdlLnNyYyA9IGRhdGEuX2xpbms7XG4gICAgdGhpcy5fcHJldk1vZGFsSW1hZ2UuYWx0ID0gZGF0YS5fbmFtZTtcbiAgICB0aGlzLl9wcmV2SW1hZ2VDYXB0aW9uLnRleHRDb250ZW50ID0gZGF0YS5fbmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gICAgdGhpcy5fc3VibWl0QnRuVGV4dCA9IHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudDtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihmbikge1xuICAgIHRoaXMuX2hhbmRsZWZvcm1TdWJtaXQgPSBmbjtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIkRlbGV0aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gdGhpcy5fc3VibWl0QnRuVGV4dDtcbiAgICB9XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlZm9ybVN1Ym1pdCgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIGludGlhbFNldHVwKGZ1bmNBcnIpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoZnVuY0Fycik7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgdXBkYXRlVXNlckF2YXRhcih1cmwpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1cmwpLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBsb2FkVXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEudGl0bGUsXG4gICAgICAgIGFib3V0OiBkYXRhLmRlc2NyaXB0aW9uLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiU2VjdGlvbiIsImNvbnN0cnVjdG9yIiwiX3JlZiIsIml0ZW1Db250YWluZXJFbCIsIml0ZW1zIiwicmVuZGVyZXIiLCJ0aGlzIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIlBvcHVwIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfbW9kYWxDbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybUlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZm9ybUVsZW1lbnQiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJ0ZXh0Q29udGVudCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJyZXNldCIsInNob3dMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJjb25zb2xlIiwibG9nIiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnRuIiwiaGFuZGxlTGlrZXMiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfbmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVCdG4iLCJfaGFuZGxlTGlrZXMiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2FyZEVsZW1lbnQiLCJnZXRJZCIsImlkIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInNldElzTGlrZWQiLCJfcmVuZGVyTGlrZXMiLCJnZXRDYXJkRWwiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiY2FyZEltYWdlRWwiLCJjYXJkVGl0bGVFbCIsInNldEF0dHJpYnV0ZSIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtRWwiLCJfZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQXJyYXkiLCJmcm9tIiwiX2J1dHRvbkVsIiwiX3Nob3dFcnJvck1lc3NhZ2UiLCJmb3JtSW5wdXQiLCJlcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVFcnJvck1lc3NhZ2UiLCJfZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJyZW1vdmVBdHRyaWJ1dGUiLCJfaGFzSW52YWxpZElucHV0cyIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInJlc2V0TW9kYWxWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwicHJvZkVkaXRCdG4iLCJwcm9mRWRpdE1vZGFsIiwicHJvZlRpdGxlIiwicHJvZkRlc2MiLCJwcm9mRWRpdE5hbWVJbnB1dCIsInByb2ZFZGl0RGVzY0lucHV0IiwicHJvZkVkaXRGb3JtIiwicHJvZkltYWdlIiwicHJvZkF2YXRhckVkaXRCdG4iLCJjYXJkTGlzdEVsIiwiY2FyZEFkZE1vZGFsIiwiY2FyZEFkZEJ0biIsImNhcmRBZGRGb3JtIiwidXBkYXRlQXZhdGFyRm9ybSIsInVzZXJJbmZvIiwibmFtZUVsZW1lbnQiLCJhYm91dEVsZW1lbnQiLCJhdmF0YXIiLCJfbmFtZUVsZW1lbnQiLCJfYWJvdXRFbGVtZW50IiwiX2F2YXRhciIsImdldFVzZXJJbmZvIiwidmFsdWVzIiwiYWJvdXQiLCJzZXRVc2VySW5mbyIsInRpdGxlRGF0YSIsImRlc2NEYXRhIiwic2V0VXNlckF2YXRhciIsInVybCIsInNyYyIsImVkaXRQcm9mTW9kYWwiLCJwcm9maWxlRGF0YSIsImFwaSIsInVwZGF0ZVVzZXJJbmZvIiwidGhlbiIsInJlcyIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJmaW5hbGx5Iiwic2V0VGltZW91dCIsImF2YXRhclVwZGF0ZU1vZGFsIiwiaW5wdXRWYWx1ZSIsInVwZGF0ZVVzZXJBdmF0YXIiLCJhZGRDYXJkTW9kYWwiLCJ0aXRsZSIsImNhcmREYXRhIiwiYWRkTmV3Q2FyZCIsImNhcmQiLCJyZW5kZXJDYXJkIiwic2VjdGlvbiIsInByZXZJbWFnZU1vZGFsIiwiX3ByZXZJbWFnZUNhcHRpb24iLCJfcHJldk1vZGFsSW1hZ2UiLCJhbHQiLCJkZWxldGVDYXJkTW9kYWwiLCJzZXRTdWJtaXRBY3Rpb24iLCJmbiIsIl9oYW5kbGVmb3JtU3VibWl0IiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyVXBkYXRlVmFsaWRhdG9yIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiaW50aWFsU2V0dXAiLCJmdW5jQXJyIiwiUHJvbWlzZSIsImFsbCIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxvYWRVc2VySW5mbyIsImRlc2NyaXB0aW9uIiwiZ2V0SW5pdGlhbENhcmRzIiwiZGVsZXRlQ2FyZCIsImNhcmRJZCIsImFkZENhcmRMaWtlIiwicmVtb3ZlQ2FyZExpa2UiLCJhdXRob3JpemF0aW9uIiwiY2FyZEluc3RhbmNlIiwiY2FyZEVsZW1lbnQiXSwic291cmNlUm9vdCI6IiJ9
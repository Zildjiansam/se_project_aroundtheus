!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class t{constructor(e){this._modalSelector=e,this._modalElement=document.querySelector(e),this._modalCloseButton=this._modalElement.querySelector(".modal__close")}open(){this._modalElement.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()})),this._modalCloseButton.addEventListener("click",(e=>{this.close()}))}}console.log.bind(console);class s extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._formInputs=this._modalElement.querySelectorAll(".modal__input"),this._formElement=this._modalElement.querySelector(".modal__form")}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._formElement.reset()}setEventListeners(){this._formElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}class r{constructor(e,t,s,r,n,o){this._isLiked=e.isLiked,this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteBtn=r,this._handleAddLike=n,this._handleDeleteLike=o}_setEventListeners(){this._cardElement.querySelector(".card__heart-button").addEventListener("click",(()=>{this._isLiked?this._handleDeleteLike(this):this._handleAddLike(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteBtn(this))),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this)}))}getId(){const e=this._id;return console.log(e),e}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}toggleLikeButton(){this._cardElement.querySelector(".card__heart-button").classList.toggle("card__heart-button_active")}getCardEl(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return this._isLiked?this._cardElement.querySelector(".card__heart-button").classList.add("card__heart-button_active"):this._cardElement.querySelector(".card__heart-button").classList.remove("card__heart-button_active"),t.textContent=this._name,e.setAttribute("alt",this._name),e.setAttribute("src",this._link),this._setEventListeners(),this._cardElement}}class n{constructor(e,t){this._formEl=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formInputs=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._buttonEl=this._formEl.querySelector(this._submitButtonSelector)}_showErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this.errorClass)}_hideErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_disableButton(){this._buttonEl.classList.add(this._inactiveButtonClass),this._buttonEl.setAttribute("disabled","")}_enableButton(){this._buttonEl.classList.remove(this._inactiveButtonClass),this._buttonEl.removeAttribute("disabled")}_hasInvalidInputs(){return this._formInputs.some((e=>!e.validity.valid||!e.value))}_checkInputValidity(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}resetModalValidity(){this._disableButton(),this._formInputs.forEach((e=>{this._hideErrorMessage(e)}))}toggleButtonState(){this._hasInvalidInputs(this._formInputs)?this._disableButton():this._enableButton()}_setEventListeners(){this.toggleButtonState(),this._formInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const o={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},i=console.log.bind(console),a=document.querySelector("#profile-edit-button"),l=document.querySelector("#profile-edit-modal"),d=document.querySelector(".profile__title"),c=document.querySelector(".profile__description"),h=l.querySelector(".modal__form"),_=h.querySelector(".modal__button"),u=document.querySelector(".profile__image"),m=document.querySelector(".profile__image_edit-button"),E=document.querySelector(".cards__list"),p=document.querySelector("#card-add-modal"),v=document.querySelector("#card-add-button"),f=p.querySelector(".modal__form"),b=f.querySelector(".modal__button"),S=document.querySelector("#card-delete-confirm-modal").querySelector(".modal__button"),y=document.querySelector("#update-avatar-modal"),g=y.querySelector(".modal__form"),L=y.querySelector(".modal__button"),C=new class{constructor(e,t,s){this._nameElement=e,this._aboutElement=t,this._avatar=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.about=this._aboutElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._aboutElement.textContent=t}setUserAvatar(e){this._avatar.src=e}}(d,c,u),k=new s("#profile-edit-modal",(function(e){C.setUserInfo(e.title,e.description),R(_),i(C.getUserInfo()),M.updateUserInfo(C.getUserInfo()).then((e=>{C.setUserInfo(e.name,e.about)})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{R(!1,_),k.close()})),k.close()})),I=new s("#update-avatar-modal",(function(e){R(L),M.updateUserAvatar(e).then((e=>{I.close(),C.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{R(L)}))})),q=new s("#card-add-modal",(function(e){R(b);const{title:t,url:s}=e,r={name:t,link:s};M.addNewCard(r).then((e=>{const t=x(e);V.addItem(t),i(JSON.stringify(e))})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{R(b)})),w.resetModalValidity(),q.close()})),B=new class extends t{constructor(e){super(e),this._prevImageCaption=this._modalElement.querySelector(".modal__preview-image-caption"),this._prevModalImage=this._modalElement.querySelector(".modal__prev-image")}open(e){this._prevModalImage.src=e._link,this._prevModalImage.alt=e._name,this._prevImageCaption.textContent=e._name,super.open()}}("#image-preview-modal"),$=new class extends t{constructor(e){super(e),this._formElement=this._modalElement.querySelector(".modal__form")}setSubmitAction(e){this._handleformSubmit=e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleformSubmit()})),super.setEventListeners()}}("#card-delete-confirm-modal"),w=new n(o,h),A=new n(o,f),U=new n(o,g),M=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}updateUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e4d91a75-4cb0-43d1-85cd-37dfda4c3b7e","Content-Type":"application/json"}});let V;function x(e){const t=new r(e,"#card-template",D,(function(e){$.open(),$.setSubmitAction((()=>{R(_),M.deleteCard(e.getId()).then((()=>{$.close(),e.handleDeleteCard()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{R(S)}))}))}),(function(e){M.addCardLike(e.getId()).then((e=>{i(e),t.toggleLikeButton()})).catch((e=>{console.error(`Error ${e}`)}))}),(function(e){M.removeCardLike(e.getId()).then((e=>{i(e),t.toggleLikeButton()})).catch((e=>{console.error(`Error ${e}`)}))}));return t.getCardEl()}function D(e){B.open(e)}function R(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";i("SAVE"),e.textContent=t}M.getInitialCards().then((t=>{V=new e({items:t,renderer:e=>{const t=x(e);V.addItem(t)}},E),V.renderItems(),i(t)})).catch((e=>{console.error(`Error ${e}`)})),M.loadUserInfo().then((e=>{i(e),C.setUserInfo(e.name,e.about),C.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)})),w.enableValidation(),A.enableValidation(),U.enableValidation(),I.setEventListeners(),k.setEventListeners(),q.setEventListeners(),B.setEventListeners(),$.setEventListeners(),a.addEventListener("click",(()=>{w.resetModalValidity(),k.open()})),m.addEventListener("click",(e=>{e.preventDefault(),I.open()})),v.addEventListener("click",(e=>{e.preventDefault(),A.resetModalValidity(),q.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QVloRyxpQkFBaUIsU0FBUyxLQUNwQ3lKLEVBQWtCaEUscUJBQ2xCd0MsRUFBY3BJLE1BQU0sSUFHdEIwRyxFQUFrQnZHLGlCQUFpQixTQUFVUSxJQUMzQ0EsRUFBRW9GLGlCQUNGa0QsRUFBa0JqSixNQUFNLElBSTFCNkcsRUFBVzFHLGlCQUFpQixTQUFVUSxJQUNwQ0EsRUFBRW9GLGlCQUNGc0UsRUFBaUJ6RSxxQkFDakJ3RCxFQUFhcEosTUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgaXRlbUNvbnRhaW5lckVsKSB7XG4gICAgdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGl0ZW1Db250YWluZXJFbDtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG5cbiAgcmVuZGVySXRlbXMoKSB7XG4gICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHRoaXMuX21vZGFsU2VsZWN0b3IgPSBtb2RhbFNlbGVjdG9yO1xuICAgIHRoaXMuX21vZGFsRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fbW9kYWxDbG9zZUJ1dHRvbiA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcbiAgfVxuXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9fb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbW9kYWxFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGUpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcbiAgICAgICAgZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIHRoaXMuX21vZGFsQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuY29uc3QgY2wgPSBjb25zb2xlLmxvZy5iaW5kKGNvbnNvbGUpO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IHRoaXMuX21vZGFsRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICB9XG5cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5fZm9ybUlucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LnJlc2V0KCk7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQnRuLFxuICAgIGhhbmRsZUFkZExpa2UsXG4gICAgaGFuZGxlRGVsZXRlTGlrZVxuICApIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdG4gPSBoYW5kbGVEZWxldGVCdG47XG4gICAgdGhpcy5faGFuZGxlQWRkTGlrZSA9IGhhbmRsZUFkZExpa2U7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlTGlrZSA9IGhhbmRsZURlbGV0ZUxpa2U7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy9jYXJkIFwibGlrZVwiIGJ1dHRvblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUxpa2UodGhpcyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5faGFuZGxlQWRkTGlrZSh0aGlzKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG5cbiAgICAvL2NhcmQgXCJkZWxldGVcIiBidXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVCdG4odGhpcykpO1xuXG4gICAgLy9wcmV2IGltYWdlIGNsaWNrXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgY29uc3QgaWQgPSB0aGlzLl9pZDtcbiAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgcmV0dXJuIGlkO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICB0b2dnbGVMaWtlQnV0dG9uKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgIC5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9faGVhcnQtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfVxuXG4gIGdldENhcmRFbCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcblxuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjYXJkSW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG4gICAgY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuXG4gICAgdGhpcy5fYnV0dG9uRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0Vycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGZvcm1JbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUVycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0cygpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9ybUlucHV0cy5zb21lKChmb3JtSW5wdXQpID0+IHtcbiAgICAgIHJldHVybiAhZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkIHx8ICFmb3JtSW5wdXQudmFsdWU7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCkge1xuICAgIGlmICghZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoZm9ybUlucHV0KTtcbiAgICB9XG4gIH1cblxuICByZXNldE1vZGFsVmFsaWRpdHkoKSB7XG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0cyh0aGlzLl9mb3JtSW5wdXRzKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICBmb3JtSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxufTtcbiIsImltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yLCBjb25maWcgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IGNsID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcblxuY29uc3QgcHJvZkVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9mRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9mVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZkRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuLy8gY29uc3QgcHJvZkVkaXROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRfbW9kYWwtaW5wdXQtbmFtZVwiKTtcbi8vIGNvbnN0IHByb2ZFZGl0RGVzY0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsLWlucHV0LWRlc2NcIik7XG5jb25zdCBwcm9mRWRpdEZvcm0gPSBwcm9mRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBwcm9mRWRpdFNhdmVCdG4gPSBwcm9mRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgcHJvZkltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbmNvbnN0IHByb2ZBdmF0YXJFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZV9lZGl0LWJ1dHRvblwiKTtcblxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZEFkZEZvcm0gPSBjYXJkQWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGNhcmRBZGRTYXZlQnRuID0gY2FyZEFkZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgY2FyZERlbENvbmZpcm1Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2NhcmQtZGVsZXRlLWNvbmZpcm0tbW9kYWxcIlxuKTtcbmNvbnN0IGNhcmREZWxDb25maXJtQnRuID0gY2FyZERlbENvbmZpcm1Nb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG5cbmNvbnN0IHVwZGF0ZUF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIpO1xuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IHVwZGF0ZUF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCB1cGRhdGVBdmF0YXJTYXZlQnRuID0gdXBkYXRlQXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbGFzcyBJbnN0YW5jZXMgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8ocHJvZlRpdGxlLCBwcm9mRGVzYywgcHJvZkltYWdlKTtcblxuY29uc3QgZWRpdFByb2ZNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZkVkaXRTdWJtaXRcbik7XG5cbmNvbnN0IGF2YXRhclVwZGF0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3VwZGF0ZS1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyVXBkYXRlXG4pO1xuXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuY29uc3QgcHJldkltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aERlbGV0ZShcIiNjYXJkLWRlbGV0ZS1jb25maXJtLW1vZGFsXCIpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZkVkaXRGb3JtKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgY2FyZEFkZEZvcm0pO1xuXG5jb25zdCBhdmF0YXJVcGRhdGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHVwZGF0ZUF2YXRhckZvcm0pO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJlNGQ5MWE3NS00Y2IwLTQzZDEtODVjZC0zN2RmZGE0YzNiN2VcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVBJIENhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5sZXQgc2VjdGlvbjtcbmFwaVxuICAuZ2V0SW5pdGlhbENhcmRzKClcbiAgLnRoZW4oKHJlcykgPT4ge1xuICAgIHNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAgICAgIHtcbiAgICAgICAgaXRlbXM6IHJlcyxcbiAgICAgICAgcmVuZGVyZXI6IChjYXJkRGF0YSkgPT4ge1xuICAgICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XG4gICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgfSxcbiAgICAgIH0sXG4gICAgICBjYXJkTGlzdEVsXG4gICAgKTtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKCk7XG4gICAgY2wocmVzKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgfSk7XG5cbmFwaVxuICAubG9hZFVzZXJJbmZvKClcbiAgLnRoZW4oKHJlcykgPT4ge1xuICAgIGNsKHJlcyk7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgfSk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdW5jdGlvbnMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgZnVuY3Rpb24gaGFuZGxlRGVsQnRuKGNhcmRJbnN0YW5jZSkge1xuICAgICAgZGVsZXRlQ2FyZE1vZGFsLm9wZW4oKTtcbiAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zZXRTdWJtaXRBY3Rpb24oKCkgPT4ge1xuICAgICAgICBsb2FkaW5nTm90aWZpY2F0aW9uKHByb2ZFZGl0U2F2ZUJ0bik7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgY2FyZEluc3RhbmNlLmhhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICAgIGxvYWRpbmdOb3RpZmljYXRpb24oY2FyZERlbENvbmZpcm1CdG4pO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSxcbiAgICBmdW5jdGlvbiBoYW5kbGVBZGRMaWtlKGNhcmRJbnN0YW5jZSkge1xuICAgICAgYXBpXG4gICAgICAgIC5hZGRDYXJkTGlrZShjYXJkSW5zdGFuY2UuZ2V0SWQoKSlcbiAgICAgICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgICAgIGNsKHJlcyk7XG4gICAgICAgICAgY2FyZC50b2dnbGVMaWtlQnV0dG9uKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgICAgIH0pO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gaGFuZGxlRGVsZXRlTGlrZShjYXJkSW5zdGFuY2UpIHtcbiAgICAgIGFwaVxuICAgICAgICAucmVtb3ZlQ2FyZExpa2UoY2FyZEluc3RhbmNlLmdldElkKCkpXG4gICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICBjbChyZXMpO1xuICAgICAgICAgIGNhcmQudG9nZ2xlTGlrZUJ1dHRvbigpO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgICAgICB9KTtcbiAgICB9XG4gICk7XG4gIHJldHVybiBjYXJkLmdldENhcmRFbCgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHByZXZJbWFnZU1vZGFsLm9wZW4oY2FyZERhdGEpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9mSW5mb1VwZGF0ZSgpIHtcbiAgbG9hZGluZ05vdGlmaWNhdGlvbihwcm9mRWRpdFNhdmVCdG4pO1xuICAvLyBsZXQgb2xkQnRuVGV4dCA9IHByb2ZFZGl0U2F2ZUJ0bi50ZXh0Q29udGVudDtcbiAgLy8gcHJvZkVkaXRTYXZlQnRuLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgY2wodXNlckluZm8uZ2V0VXNlckluZm8oKSk7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VySW5mbyh1c2VySW5mby5nZXRVc2VySW5mbygpKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKHJlcy5uYW1lLCByZXMuYWJvdXQpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgbG9hZGluZ05vdGlmaWNhdGlvbihmYWxzZSwgcHJvZkVkaXRTYXZlQnRuKTtcbiAgICAgIGVkaXRQcm9mTW9kYWwuY2xvc2UoKTtcbiAgICAgIC8vIHByb2ZFZGl0U2F2ZUJ0bi50ZXh0Q29udGVudCA9IG9sZEJ0blRleHQ7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUF2YXRhclVwZGF0ZShpbnB1dFZhbHVlKSB7XG4gIGxvYWRpbmdOb3RpZmljYXRpb24odXBkYXRlQXZhdGFyU2F2ZUJ0bik7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VyQXZhdGFyKGlucHV0VmFsdWUpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgYXZhdGFyVXBkYXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBsb2FkaW5nTm90aWZpY2F0aW9uKHVwZGF0ZUF2YXRhclNhdmVCdG4pO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9mRWRpdFN1Ym1pdChwcm9maWxlRGF0YSkge1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhwcm9maWxlRGF0YS50aXRsZSwgcHJvZmlsZURhdGEuZGVzY3JpcHRpb24pO1xuICBoYW5kbGVQcm9mSW5mb1VwZGF0ZSgpO1xuICBlZGl0UHJvZk1vZGFsLmNsb3NlKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgbG9hZGluZ05vdGlmaWNhdGlvbihjYXJkQWRkU2F2ZUJ0bik7XG4gIGNvbnN0IHsgdGl0bGUsIHVybCB9ID0gaW5wdXRWYWx1ZXM7XG4gIGNvbnN0IGNhcmREYXRhID0geyBuYW1lOiB0aXRsZSwgbGluazogdXJsIH07XG4gIGFwaVxuICAgIC5hZGROZXdDYXJkKGNhcmREYXRhKVxuICAgIC50aGVuKChjYXJkRGF0YSkgPT4ge1xuICAgICAgY29uc3QgY2FyZCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgICAgY2woSlNPTi5zdHJpbmdpZnkoY2FyZERhdGEpKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIGxvYWRpbmdOb3RpZmljYXRpb24oY2FyZEFkZFNhdmVCdG4pO1xuICAgIH0pO1xuICBlZGl0Rm9ybVZhbGlkYXRvci5yZXNldE1vZGFsVmFsaWRpdHkoKTtcbiAgYWRkQ2FyZE1vZGFsLmNsb3NlKCk7XG59XG5cbmZ1bmN0aW9uIGxvYWRpbmdOb3RpZmljYXRpb24oYnV0dG9uLCBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCIpIHtcbiAgY2woXCJTQVZFXCIpO1xuICBidXR0b24udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9uIENhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hdmF0YXJVcGRhdGVWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hdmF0YXJVcGRhdGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5lZGl0UHJvZk1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5wcmV2SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5kZWxldGVDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJvZmlsZSBCdXR0b24gTGlzdGVuZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxucHJvZkVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRNb2RhbFZhbGlkaXR5KCk7XG4gIGVkaXRQcm9mTW9kYWwub3BlbigpO1xufSk7XG5cbnByb2ZBdmF0YXJFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG4gIGF2YXRhclVwZGF0ZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBDYXJkIEJ1dHRvbiBMaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY2FyZEFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0TW9kYWxWYWxpZGl0eSgpO1xuICBhZGRDYXJkTW9kYWwub3BlbigpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWVFbGVtZW50LCBhYm91dEVsZW1lbnQsIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZUVsZW1lbnQ7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50ID0gYWJvdXRFbGVtZW50O1xuICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xuICAgIHZhbHVlcy5uYW1lID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgdmFsdWVzLmFib3V0ID0gdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50O1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBzZXRVc2VySW5mbyh0aXRsZURhdGEsIGRlc2NEYXRhKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZURhdGE7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY0RhdGE7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHVybCkge1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSB1cmw7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX3ByZXZJbWFnZUNhcHRpb24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlLWNhcHRpb25cIlxuICAgICk7XG4gICAgdGhpcy5fcHJldk1vZGFsSW1hZ2UgPVxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXYtaW1hZ2VcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9wcmV2TW9kYWxJbWFnZS5zcmMgPSBkYXRhLl9saW5rO1xuICAgIHRoaXMuX3ByZXZNb2RhbEltYWdlLmFsdCA9IGRhdGEuX25hbWU7XG4gICAgdGhpcy5fcHJldkltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuX25hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgfVxuXG4gIHNldFN1Ym1pdEFjdGlvbihmbikge1xuICAgIHRoaXMuX2hhbmRsZWZvcm1TdWJtaXQgPSBmbjtcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVmb3JtU3VibWl0KCk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIHRoaXMuX3VybCA9IG9wdGlvbnMuYmFzZVVybDtcbiAgICB0aGlzLl9oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJBdmF0YXIodXJsKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXJsKSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbG9hZFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8oZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZE5ld0NhcmQoZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgbGluazogZGF0YS5saW5rLFxuICAgICAgfSksXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGRlbGV0ZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9YCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgcmVtb3ZlQ2FyZExpa2UoY2FyZElkKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG59XG4iXSwibmFtZXMiOlsiU2VjdGlvbiIsImNvbnN0cnVjdG9yIiwiX3JlZiIsIml0ZW1Db250YWluZXJFbCIsIml0ZW1zIiwicmVuZGVyZXIiLCJ0aGlzIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImFkZEl0ZW0iLCJlbGVtZW50IiwicHJlcGVuZCIsInJlbmRlckl0ZW1zIiwiZm9yRWFjaCIsIlBvcHVwIiwibW9kYWxTZWxlY3RvciIsIl9tb2RhbFNlbGVjdG9yIiwiX21vZGFsRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9tb2RhbENsb3NlQnV0dG9uIiwib3BlbiIsImNsYXNzTGlzdCIsImFkZCIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRXNjQ2xvc2UiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsImUiLCJ0YXJnZXQiLCJjb250YWlucyIsImNvbnNvbGUiLCJsb2ciLCJiaW5kIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2Zvcm1FbGVtZW50IiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJpbnB1dCIsIm5hbWUiLCJ2YWx1ZSIsInJlc2V0IiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnRuIiwiaGFuZGxlQWRkTGlrZSIsImhhbmRsZURlbGV0ZUxpa2UiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfbmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9jYXJkU2VsZWN0b3IiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVCdG4iLCJfaGFuZGxlQWRkTGlrZSIsIl9oYW5kbGVEZWxldGVMaWtlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRFbGVtZW50IiwiZ2V0SWQiLCJpZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJ0b2dnbGVMaWtlQnV0dG9uIiwidG9nZ2xlIiwiZ2V0Q2FyZEVsIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsIiwiY2FyZFRpdGxlRWwiLCJ0ZXh0Q29udGVudCIsInNldEF0dHJpYnV0ZSIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtRWwiLCJfZm9ybUVsIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiQXJyYXkiLCJmcm9tIiwiX2J1dHRvbkVsIiwiX3Nob3dFcnJvck1lc3NhZ2UiLCJmb3JtSW5wdXQiLCJlcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVFcnJvck1lc3NhZ2UiLCJfZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJyZW1vdmVBdHRyaWJ1dGUiLCJfaGFzSW52YWxpZElucHV0cyIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInJlc2V0TW9kYWxWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZW5hYmxlVmFsaWRhdGlvbiIsInByZXZlbnREZWZhdWx0IiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiY2wiLCJwcm9mRWRpdEJ0biIsInByb2ZFZGl0TW9kYWwiLCJwcm9mVGl0bGUiLCJwcm9mRGVzYyIsInByb2ZFZGl0Rm9ybSIsInByb2ZFZGl0U2F2ZUJ0biIsInByb2ZJbWFnZSIsInByb2ZBdmF0YXJFZGl0QnRuIiwiY2FyZExpc3RFbCIsImNhcmRBZGRNb2RhbCIsImNhcmRBZGRCdG4iLCJjYXJkQWRkRm9ybSIsImNhcmRBZGRTYXZlQnRuIiwiY2FyZERlbENvbmZpcm1CdG4iLCJ1cGRhdGVBdmF0YXJNb2RhbCIsInVwZGF0ZUF2YXRhckZvcm0iLCJ1cGRhdGVBdmF0YXJTYXZlQnRuIiwidXNlckluZm8iLCJuYW1lRWxlbWVudCIsImFib3V0RWxlbWVudCIsImF2YXRhciIsIl9uYW1lRWxlbWVudCIsIl9hYm91dEVsZW1lbnQiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJ2YWx1ZXMiLCJhYm91dCIsInNldFVzZXJJbmZvIiwidGl0bGVEYXRhIiwiZGVzY0RhdGEiLCJzZXRVc2VyQXZhdGFyIiwidXJsIiwic3JjIiwiZWRpdFByb2ZNb2RhbCIsInByb2ZpbGVEYXRhIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsImxvYWRpbmdOb3RpZmljYXRpb24iLCJhcGkiLCJ1cGRhdGVVc2VySW5mbyIsInRoZW4iLCJyZXMiLCJjYXRjaCIsImVyciIsImVycm9yIiwiZmluYWxseSIsImF2YXRhclVwZGF0ZU1vZGFsIiwiaW5wdXRWYWx1ZSIsInVwZGF0ZVVzZXJBdmF0YXIiLCJhZGRDYXJkTW9kYWwiLCJjYXJkRGF0YSIsImFkZE5ld0NhcmQiLCJjYXJkIiwicmVuZGVyQ2FyZCIsInNlY3Rpb24iLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJwcmV2SW1hZ2VNb2RhbCIsIl9wcmV2SW1hZ2VDYXB0aW9uIiwiX3ByZXZNb2RhbEltYWdlIiwiYWx0IiwiZGVsZXRlQ2FyZE1vZGFsIiwic2V0U3VibWl0QWN0aW9uIiwiZm4iLCJfaGFuZGxlZm9ybVN1Ym1pdCIsImFkZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJVcGRhdGVWYWxpZGF0b3IiLCJvcHRpb25zIiwiX3VybCIsImJhc2VVcmwiLCJfaGVhZGVycyIsImhlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJmZXRjaCIsIm1ldGhvZCIsImJvZHkiLCJsb2FkVXNlckluZm8iLCJnZXRJbml0aWFsQ2FyZHMiLCJkZWxldGVDYXJkIiwiY2FyZElkIiwiYWRkQ2FyZExpa2UiLCJyZW1vdmVDYXJkTGlrZSIsImF1dGhvcml6YXRpb24iLCJjYXJkSW5zdGFuY2UiLCJidXR0b24iLCJsb2FkaW5nVGV4dCIsImFyZ3VtZW50cyIsImxlbmd0aCIsInVuZGVmaW5lZCIsImNhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==
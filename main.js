!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class t{constructor(e){this._modalElement=document.querySelector(e),this._modalCloseButton=this._modalElement.querySelector(".modal__close")}open(){this._modalElement.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalElement.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()})),this._modalCloseButton.addEventListener("click",(e=>{this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._formInputs=this._modalElement.querySelectorAll(".modal__input"),this._formElement=this._modalElement.querySelector(".modal__form"),this._submitBtn=this._modalElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._formElement.reset()}showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){this._formElement.addEventListener("submit",(()=>{console.log(this._getInputValues()),this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}class r{constructor(e,t,s,r,n){this._isLiked=e.isLiked,this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteBtn=r,this._handleLikes=n}_setEventListeners(){this._cardElement.querySelector(".card__heart-button").addEventListener("click",(()=>{this._handleLikes(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteBtn(this))),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this)}))}getId(){const e=this._id;return console.log(e),e}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}_renderLikes(){this._isLiked?this._cardElement.querySelector(".card__heart-button").classList.add("card__heart-button_active"):this._cardElement.querySelector(".card__heart-button").classList.remove("card__heart-button_active")}getCardEl(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return this._renderLikes(),t.textContent=this._name,e.setAttribute("alt",this._name),e.setAttribute("src",this._link),this._setEventListeners(),this._cardElement}}class n{constructor(e,t){this._formEl=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formInputs=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._buttonEl=this._formEl.querySelector(this._submitButtonSelector)}_showErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this.errorClass)}_hideErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_disableButton(){this._buttonEl.classList.add(this._inactiveButtonClass),this._buttonEl.setAttribute("disabled","")}_enableButton(){this._buttonEl.classList.remove(this._inactiveButtonClass),this._buttonEl.removeAttribute("disabled")}_hasInvalidInputs(){return this._formInputs.some((e=>!e.validity.valid||!e.value))}_checkInputValidity(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}resetModalValidity(){this._disableButton(),this._formInputs.forEach((e=>{this._hideErrorMessage(e)}))}toggleButtonState(){this._hasInvalidInputs(this._formInputs)?this._disableButton():this._enableButton()}_setEventListeners(){this.toggleButtonState(),this._formInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const i={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},o=document.querySelector("#profile-edit-button"),a=document.querySelector("#profile-edit-modal"),l=document.querySelector(".profile__title"),d=document.querySelector(".profile__description"),c=document.querySelector("#edit_modal-input-name"),h=document.querySelector("#edit-modal-input-desc"),_=a.querySelector(".modal__form"),u=document.querySelector(".profile__image"),m=document.querySelector(".profile__image_edit-button"),E=document.querySelector(".cards__list"),p=document.querySelector("#card-add-modal"),v=document.querySelector("#card-add-button"),f=p.querySelector(".modal__form"),L=document.querySelector("#update-avatar-modal").querySelector(".modal__form"),b=new class{constructor(e,t,s){this._nameElement=e,this._aboutElement=t,this._avatar=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.about=this._aboutElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._aboutElement.textContent=t}setUserAvatar(e){this._avatar.src=e}}(l,d,u),S=new s("#profile-edit-modal",(function(e){S.showLoading(!0),B.updateUserInfo(e).then((e=>{b.setUserInfo(e.name,e.about),S.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{S.showLoading(!1)}),1e3)}))})),y=new s("#update-avatar-modal",(function(e){y.showLoading(!0),B.updateUserAvatar(e).then((e=>{y.close(),b.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{y.showLoading(!1)}),1e3)}))})),g=new s("#card-add-modal",(function(e){g.showLoading(!0);const{title:t,url:s}=e,r={name:t,link:s};B.addNewCard(r).then((e=>{const t=x(e);$.addItem(t),g.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{g.showLoading(!1)}),1e3)}))})),C=new class extends t{constructor(e){super(e),this._prevImageCaption=this._modalElement.querySelector(".modal__preview-image-caption"),this._prevModalImage=this._modalElement.querySelector(".modal__prev-image")}open(e){this._prevModalImage.src=e._link,this._prevModalImage.alt=e._name,this._prevImageCaption.textContent=e._name,super.open()}}("#image-preview-modal"),k=new class extends t{constructor(e){super(e),this._formElement=this._modalElement.querySelector(".modal__form"),this._submitBtn=this._modalElement.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}setSubmitAction(e){this._handleformSubmit=e}showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleformSubmit()})),super.setEventListeners()}}("#card-delete-confirm-modal"),I=new n(i,_),q=new n(i,f),w=new n(i,L),B=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}intialSetup(e){return Promise.all(e)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}updateUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.title,about:e.description})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e4d91a75-4cb0-43d1-85cd-37dfda4c3b7e","Content-Type":"application/json"}});let $;function x(e){const t=new r(e,"#card-template",A,(function(e){k.open(),k.setSubmitAction((()=>{k.showLoading(!0),B.deleteCard(e.getId()).then((()=>{k.close(),e.handleDeleteCard()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{k.showLoading(!1)}),1e3)}))}))}),(function(e){t.isLiked()?B.removeCardLike(e.getId()).then((e=>{t.setIsLiked(e._isLiked)})).catch((e=>{console.error(`Error ${e}`)})):B.addCardLike(e.getId()).then((e=>{t.setIsLiked(!e._isLiked)})).catch((e=>{console.error(`Error ${e}`)}))}));return t.getCardEl()}function A(e){C.open(e)}B.intialSetup([void B.getInitialCards().then((t=>{$=new e({items:t,renderer:e=>{const t=x(e);$.addItem(t)}},E),$.renderItems()})).catch((e=>{console.error(`Error ${e}`)})),void B.loadUserInfo().then((e=>{b.setUserInfo(e.name,e.about),b.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)}))]),I.enableValidation(),q.enableValidation(),w.enableValidation(),y.setEventListeners(),S.setEventListeners(),g.setEventListeners(),C.setEventListeners(),k.setEventListeners(),o.addEventListener("click",(()=>{I.resetModalValidity(),c.value=l.textContent,h.value=d.textContent,S.open()})),m.addEventListener("click",(e=>{e.preventDefault(),w.resetModalValidity(),y.open()})),v.addEventListener("click",(e=>{e.preventDefault(),q.resetModalValidity(),g.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TnhHLFFBQVF5RyxNQUFPLFNBQVFELElBQU0sTUFxRW5Dc0IsRUFBa0IvRCxtQkFFbEJnRSxFQUFpQmhFLG1CQUVqQmlFLEVBQXNCakUsbUJBRXRCNkMsRUFBa0J0SSxvQkFFbEIySCxFQUFjM0gsb0JBRWR5SSxFQUFhekksb0JBRWJnSixFQUFlaEosb0JBRWZvSixFQUFnQnBKLG9CQUloQjZGLEVBQVlwRyxpQkFBaUIsU0FBUyxLQUNwQytKLEVBQWtCakUscUJBQ2xCVSxFQUFrQi9FLE1BQVE2RSxFQUFVbEYsWUFDcENxRixFQUFrQmhGLE1BQVE4RSxFQUFTbkYsWUFDbkM4RyxFQUFjckksTUFBTSxJQUd0QitHLEVBQWtCNUcsaUJBQWlCLFNBQVVRLElBQzNDQSxFQUFFeUYsaUJBQ0ZnRSxFQUFzQm5FLHFCQUN0QitDLEVBQWtCaEosTUFBTSxJQUkxQmtILEVBQVcvRyxpQkFBaUIsU0FBVVEsSUFDcENBLEVBQUV5RixpQkFDRitELEVBQWlCbEUscUJBQ2pCa0QsRUFBYW5KLE1BQU0sRyIsInNvdXJjZXMiOlsid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3BhZ2VzL2luZGV4LmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aERlbGV0ZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VjdGlvbiB7XG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGl0ZW1Db250YWluZXJFbCkge1xuICAgIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9jb250YWluZXIgPSBpdGVtQ29udGFpbmVyRWw7XG4gIH1cblxuICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICB0aGlzLl9jb250YWluZXIucHJlcGVuZChlbGVtZW50KTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKCkge1xuICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICAvLyB0aGlzLl9tb2RhbFNlbGVjdG9yID0gbW9kYWxTZWxlY3RvcjtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX21vZGFsQ2xvc2VCdXR0b24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9tb2RhbEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX19vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xuICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4gICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxuICB9O1xuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHRoaXMuX21vZGFsRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9tb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgfSk7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQnRuLFxuICAgIGhhbmRsZUxpa2VzXG4gICkge1xuICAgIHRoaXMuX2lzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5fbmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XG4gICAgdGhpcy5fY2FyZFNlbGVjdG9yID0gY2FyZFNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUJ0biA9IGhhbmRsZURlbGV0ZUJ0bjtcbiAgICB0aGlzLl9oYW5kbGVMaWtlcyA9IGhhbmRsZUxpa2VzO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vY2FyZCBcImxpa2VcIiBidXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faGVhcnQtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZXModGhpcyk7XG4gICAgICB9KTtcblxuICAgIC8vY2FyZCBcImRlbGV0ZVwiIGJ1dHRvblxuICAgIHRoaXMuX2NhcmRFbGVtZW50XG4gICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuX2hhbmRsZURlbGV0ZUJ0bih0aGlzKSk7XG5cbiAgICAvL3ByZXYgaW1hZ2UgY2xpY2tcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMpO1xuICAgICAgfSk7XG4gIH1cblxuICBnZXRJZCgpIHtcbiAgICBjb25zdCBpZCA9IHRoaXMuX2lkO1xuICAgIGNvbnNvbGUubG9nKGlkKTtcbiAgICByZXR1cm4gaWQ7XG4gIH1cblxuICBoYW5kbGVEZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gbnVsbDtcbiAgfVxuXG4gIHNldElzTGlrZWQoaXNMaWtlZCkge1xuICAgIHRoaXMuX2lzTGlrZWQgPSBpc0xpa2VkO1xuICAgIHRoaXMuX3JlbmRlckxpa2VzKCk7XG4gIH1cblxuICBpc0xpa2VkKCkge1xuICAgIHJldHVybiB0aGlzLl9pc0xpa2VkO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldENhcmRFbCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjYXJkSW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG4gICAgY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuXG4gICAgdGhpcy5fYnV0dG9uRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0Vycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGZvcm1JbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUVycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0cygpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9ybUlucHV0cy5zb21lKChmb3JtSW5wdXQpID0+IHtcbiAgICAgIHJldHVybiAhZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkIHx8ICFmb3JtSW5wdXQudmFsdWU7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCkge1xuICAgIGlmICghZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoZm9ybUlucHV0KTtcbiAgICB9XG4gIH1cblxuICByZXNldE1vZGFsVmFsaWRpdHkoKSB7XG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0cyh0aGlzLl9mb3JtSW5wdXRzKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICBmb3JtSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxufTtcbiIsImltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yLCBjb25maWcgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8vIGNvbnN0IGNsID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcblxuY29uc3QgcHJvZkVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9mRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9mVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZkRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZkVkaXROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRfbW9kYWwtaW5wdXQtbmFtZVwiKTtcbmNvbnN0IHByb2ZFZGl0RGVzY0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsLWlucHV0LWRlc2NcIik7XG5jb25zdCBwcm9mRWRpdEZvcm0gPSBwcm9mRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBwcm9mSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlXCIpO1xuY29uc3QgcHJvZkF2YXRhckVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2ltYWdlX2VkaXQtYnV0dG9uXCIpO1xuXG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmNvbnN0IGNhcmRBZGRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtbW9kYWxcIik7XG5jb25zdCBjYXJkQWRkQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLWFkZC1idXR0b25cIik7XG5jb25zdCBjYXJkQWRkRm9ybSA9IGNhcmRBZGRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG5jb25zdCB1cGRhdGVBdmF0YXJNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjdXBkYXRlLWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IHVwZGF0ZUF2YXRhckZvcm0gPSB1cGRhdGVBdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbGFzcyBJbnN0YW5jZXMgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8ocHJvZlRpdGxlLCBwcm9mRGVzYywgcHJvZkltYWdlKTtcblxuY29uc3QgZWRpdFByb2ZNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZkluZm9VcGRhdGVcbik7XG5cbmNvbnN0IGF2YXRhclVwZGF0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3VwZGF0ZS1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyVXBkYXRlXG4pO1xuXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuY29uc3QgcHJldkltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aERlbGV0ZShcIiNjYXJkLWRlbGV0ZS1jb25maXJtLW1vZGFsXCIpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZkVkaXRGb3JtKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgY2FyZEFkZEZvcm0pO1xuXG5jb25zdCBhdmF0YXJVcGRhdGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHVwZGF0ZUF2YXRhckZvcm0pO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJlNGQ5MWE3NS00Y2IwLTQzZDEtODVjZC0zN2RmZGE0YzNiN2VcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVBJIENhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmxldCBzZWN0aW9uO1xuXG5hcGkuaW50aWFsU2V0dXAoW2dldEluaXRhbENhcmRzKCksIGdldEluaXRpYWxJbmZvKCldKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBmdW5jdGlvbiBoYW5kbGVEZWxCdG4oY2FyZEluc3RhbmNlKSB7XG4gICAgICBkZWxldGVDYXJkTW9kYWwub3BlbigpO1xuICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zaG93TG9hZGluZyh0cnVlKTtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmRlbGV0ZUNhcmQoY2FyZEluc3RhbmNlLmdldElkKCkpXG4gICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgZGVsZXRlQ2FyZE1vZGFsLmNsb3NlKCk7XG4gICAgICAgICAgICBjYXJkSW5zdGFuY2UuaGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XG4gICAgICAgICAgICB9LCAxMDAwKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gaGFuZGxlTGlrZXMoY2FyZEluc3RhbmNlKSB7XG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnJlbW92ZUNhcmRMaWtlKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQuc2V0SXNMaWtlZChyZXMuX2lzTGlrZWQpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZENhcmRMaWtlKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQuc2V0SXNMaWtlZCghcmVzLl9pc0xpa2VkKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJldHVybiBjYXJkLmdldENhcmRFbCgpO1xufVxuXG5mdW5jdGlvbiBnZXRJbml0YWxDYXJkcygpIHtcbiAgYXBpXG4gICAgLmdldEluaXRpYWxDYXJkcygpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICB7XG4gICAgICAgICAgaXRlbXM6IHJlcyxcbiAgICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBjYXJkTGlzdEVsXG4gICAgICApO1xuICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBnZXRJbml0aWFsSW5mbygpIHtcbiAgYXBpXG4gICAgLmxvYWRVc2VySW5mbygpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgICB1c2VySW5mby5zZXRVc2VyQXZhdGFyKHJlcy5hdmF0YXIpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XG4gIHByZXZJbWFnZU1vZGFsLm9wZW4oY2FyZERhdGEpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9mSW5mb1VwZGF0ZShwcm9maWxlRGF0YSkge1xuICBlZGl0UHJvZk1vZGFsLnNob3dMb2FkaW5nKHRydWUpO1xuICBhcGlcbiAgICAudXBkYXRlVXNlckluZm8ocHJvZmlsZURhdGEpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgICBlZGl0UHJvZk1vZGFsLmNsb3NlKCk7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgZWRpdFByb2ZNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyVXBkYXRlKGlucHV0VmFsdWUpIHtcbiAgYXZhdGFyVXBkYXRlTW9kYWwuc2hvd0xvYWRpbmcodHJ1ZSk7XG4gIGFwaVxuICAgIC51cGRhdGVVc2VyQXZhdGFyKGlucHV0VmFsdWUpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgYXZhdGFyVXBkYXRlTW9kYWwuY2xvc2UoKTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgYXZhdGFyVXBkYXRlTW9kYWwuc2hvd0xvYWRpbmcoZmFsc2UpO1xuICAgICAgfSwgMTAwMCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgYWRkQ2FyZE1vZGFsLnNob3dMb2FkaW5nKHRydWUpO1xuICBjb25zdCB7IHRpdGxlLCB1cmwgfSA9IGlucHV0VmFsdWVzO1xuICBjb25zdCBjYXJkRGF0YSA9IHsgbmFtZTogdGl0bGUsIGxpbms6IHVybCB9O1xuICBhcGlcbiAgICAuYWRkTmV3Q2FyZChjYXJkRGF0YSlcbiAgICAudGhlbigoY2FyZERhdGEpID0+IHtcbiAgICAgIGNvbnN0IGNhcmQgPSByZW5kZXJDYXJkKGNhcmREYXRhKTtcbiAgICAgIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICAgIGFkZENhcmRNb2RhbC5jbG9zZSgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgIH0pXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGFkZENhcmRNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9KTtcbn1cblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9uIENhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hdmF0YXJVcGRhdGVWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hdmF0YXJVcGRhdGVNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5lZGl0UHJvZk1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmFkZENhcmRNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5wcmV2SW1hZ2VNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5kZWxldGVDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gUHJvZmlsZSBCdXR0b24gTGlzdGVuZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxucHJvZkVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgZWRpdEZvcm1WYWxpZGF0b3IucmVzZXRNb2RhbFZhbGlkaXR5KCk7XG4gIHByb2ZFZGl0TmFtZUlucHV0LnZhbHVlID0gcHJvZlRpdGxlLnRleHRDb250ZW50O1xuICBwcm9mRWRpdERlc2NJbnB1dC52YWx1ZSA9IHByb2ZEZXNjLnRleHRDb250ZW50O1xuICBlZGl0UHJvZk1vZGFsLm9wZW4oKTtcbn0pO1xuXG5wcm9mQXZhdGFyRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBhdmF0YXJVcGRhdGVWYWxpZGF0b3IucmVzZXRNb2RhbFZhbGlkaXR5KCk7XG4gIGF2YXRhclVwZGF0ZU1vZGFsLm9wZW4oKTtcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSBDYXJkIEJ1dHRvbiBMaXN0ZW5lcnMgLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY2FyZEFkZEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICBhZGRGb3JtVmFsaWRhdG9yLnJlc2V0TW9kYWxWYWxpZGl0eSgpO1xuICBhZGRDYXJkTW9kYWwub3BlbigpO1xufSk7XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKG5hbWVFbGVtZW50LCBhYm91dEVsZW1lbnQsIGF2YXRhcikge1xuICAgIHRoaXMuX25hbWVFbGVtZW50ID0gbmFtZUVsZW1lbnQ7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50ID0gYWJvdXRFbGVtZW50O1xuICAgIHRoaXMuX2F2YXRhciA9IGF2YXRhcjtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xuICAgIHZhbHVlcy5uYW1lID0gdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQ7XG4gICAgdmFsdWVzLmFib3V0ID0gdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50O1xuICAgIHJldHVybiB2YWx1ZXM7XG4gIH1cblxuICBzZXRVc2VySW5mbyh0aXRsZURhdGEsIGRlc2NEYXRhKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZURhdGE7XG4gICAgdGhpcy5fYWJvdXRFbGVtZW50LnRleHRDb250ZW50ID0gZGVzY0RhdGE7XG4gIH1cblxuICBzZXRVc2VyQXZhdGFyKHVybCkge1xuICAgIHRoaXMuX2F2YXRhci5zcmMgPSB1cmw7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3Rvcikge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX3ByZXZJbWFnZUNhcHRpb24gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19wcmV2aWV3LWltYWdlLWNhcHRpb25cIlxuICAgICk7XG4gICAgdGhpcy5fcHJldk1vZGFsSW1hZ2UgPVxuICAgICAgdGhpcy5fbW9kYWxFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXYtaW1hZ2VcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9wcmV2TW9kYWxJbWFnZS5zcmMgPSBkYXRhLl9saW5rO1xuICAgIHRoaXMuX3ByZXZNb2RhbEltYWdlLmFsdCA9IGRhdGEuX25hbWU7XG4gICAgdGhpcy5fcHJldkltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuX25hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdG4gPSB0aGlzLl9tb2RhbEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oZm4pIHtcbiAgICB0aGlzLl9oYW5kbGVmb3JtU3VibWl0ID0gZm47XG4gIH1cblxuICBzaG93TG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJEZWxldGluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHRoaXMuX2hhbmRsZWZvcm1TdWJtaXQoKTtcbiAgICB9KTtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgdGhpcy5fdXJsID0gb3B0aW9ucy5iYXNlVXJsO1xuICAgIHRoaXMuX2hlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnM7XG4gIH1cblxuICBpbnRpYWxTZXR1cChmdW5jQXJyKSB7XG4gICAgcmV0dXJuIFByb21pc2UuYWxsKGZ1bmNBcnIpO1xuICB9XG5cbiAgX2NoZWNrUmVzcG9uc2UocmVzKSB7XG4gICAgaWYgKHJlcy5vaykge1xuICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgfVxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgfVxuXG4gIHVwZGF0ZVVzZXJBdmF0YXIodXJsKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkodXJsKSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgbG9hZFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8oZGF0YSkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLnRpdGxlLFxuICAgICAgICBhYm91dDogZGF0YS5kZXNjcmlwdGlvbixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGROZXdDYXJkKGRhdGEpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGxpbms6IGRhdGEubGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBkZWxldGVDYXJkKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfWAsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIGFkZENhcmRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxuXG4gIHJlbW92ZUNhcmRMaWtlKGNhcmRJZCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSkudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKTtcbiAgfVxufVxuIl0sIm5hbWVzIjpbIlNlY3Rpb24iLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJpdGVtQ29udGFpbmVyRWwiLCJpdGVtcyIsInJlbmRlcmVyIiwidGhpcyIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJQb3B1cCIsIm1vZGFsU2VsZWN0b3IiLCJfbW9kYWxFbGVtZW50IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiX21vZGFsQ2xvc2VCdXR0b24iLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NDbG9zZSIsImNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwiZSIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1JbnB1dHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX2Zvcm1FbGVtZW50IiwiX3N1Ym1pdEJ0biIsIl9zdWJtaXRCdG5UZXh0IiwidGV4dENvbnRlbnQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwibmFtZSIsInZhbHVlIiwicmVzZXQiLCJzaG93TG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwiY29uc29sZSIsImxvZyIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUJ0biIsImhhbmRsZUxpa2VzIiwiX2lzTGlrZWQiLCJpc0xpa2VkIiwiX25hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQnRuIiwiX2hhbmRsZUxpa2VzIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRFbGVtZW50IiwiZ2V0SWQiLCJpZCIsImhhbmRsZURlbGV0ZUNhcmQiLCJzZXRJc0xpa2VkIiwiX3JlbmRlckxpa2VzIiwiZ2V0Q2FyZEVsIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsIiwiY2FyZFRpdGxlRWwiLCJzZXRBdHRyaWJ1dGUiLCJGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybUVsIiwiX2Zvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkFycmF5IiwiZnJvbSIsIl9idXR0b25FbCIsIl9zaG93RXJyb3JNZXNzYWdlIiwiZm9ybUlucHV0IiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3JNZXNzYWdlIiwiX2Rpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiX2hhc0ludmFsaWRJbnB1dHMiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJyZXNldE1vZGFsVmFsaWRpdHkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsInByb2ZFZGl0QnRuIiwicHJvZkVkaXRNb2RhbCIsInByb2ZUaXRsZSIsInByb2ZEZXNjIiwicHJvZkVkaXROYW1lSW5wdXQiLCJwcm9mRWRpdERlc2NJbnB1dCIsInByb2ZFZGl0Rm9ybSIsInByb2ZJbWFnZSIsInByb2ZBdmF0YXJFZGl0QnRuIiwiY2FyZExpc3RFbCIsImNhcmRBZGRNb2RhbCIsImNhcmRBZGRCdG4iLCJjYXJkQWRkRm9ybSIsInVwZGF0ZUF2YXRhckZvcm0iLCJ1c2VySW5mbyIsIm5hbWVFbGVtZW50IiwiYWJvdXRFbGVtZW50IiwiYXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInZhbHVlcyIsImFib3V0Iiwic2V0VXNlckluZm8iLCJ0aXRsZURhdGEiLCJkZXNjRGF0YSIsInNldFVzZXJBdmF0YXIiLCJ1cmwiLCJzcmMiLCJlZGl0UHJvZk1vZGFsIiwicHJvZmlsZURhdGEiLCJhcGkiLCJ1cGRhdGVVc2VySW5mbyIsInRoZW4iLCJyZXMiLCJjYXRjaCIsImVyciIsImVycm9yIiwiZmluYWxseSIsInNldFRpbWVvdXQiLCJhdmF0YXJVcGRhdGVNb2RhbCIsImlucHV0VmFsdWUiLCJ1cGRhdGVVc2VyQXZhdGFyIiwiYWRkQ2FyZE1vZGFsIiwidGl0bGUiLCJjYXJkRGF0YSIsImFkZE5ld0NhcmQiLCJjYXJkIiwicmVuZGVyQ2FyZCIsInNlY3Rpb24iLCJwcmV2SW1hZ2VNb2RhbCIsIl9wcmV2SW1hZ2VDYXB0aW9uIiwiX3ByZXZNb2RhbEltYWdlIiwiYWx0IiwiZGVsZXRlQ2FyZE1vZGFsIiwic2V0U3VibWl0QWN0aW9uIiwiZm4iLCJfaGFuZGxlZm9ybVN1Ym1pdCIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhclVwZGF0ZVZhbGlkYXRvciIsIm9wdGlvbnMiLCJfdXJsIiwiYmFzZVVybCIsIl9oZWFkZXJzIiwiaGVhZGVycyIsImludGlhbFNldHVwIiwiZnVuY0FyciIsIlByb21pc2UiLCJhbGwiLCJfY2hlY2tSZXNwb25zZSIsIm9rIiwianNvbiIsInJlamVjdCIsInN0YXR1cyIsImZldGNoIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJsb2FkVXNlckluZm8iLCJkZXNjcmlwdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRDYXJkTGlrZSIsInJlbW92ZUNhcmRMaWtlIiwiYXV0aG9yaXphdGlvbiIsImNhcmRJbnN0YW5jZSIsImNhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==
!function(){"use strict";class e{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=t}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class t{constructor(e){this._modalSelector=document.querySelector(e),this._modalCloseButton=this._modalSelector.querySelector(".modal__close")}open(){this._modalSelector.classList.add("modal__opened"),document.addEventListener("keydown",this._handleEscClose)}close(){this._modalSelector.classList.remove("modal__opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._modalSelector.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()})),this._modalCloseButton.addEventListener("click",(e=>{this.close()}))}}class s extends t{constructor(e,t){super(e),this._handleFormSubmit=t,this._formInputs=this._modalSelector.querySelectorAll(".modal__input"),this._formElement=this._modalSelector.querySelector(".modal__form"),this._submitBtn=this._modalSelector.querySelector(".modal__button"),this._submitBtnText=this._submitBtn.textContent}_getInputValues(){const e={};return this._formInputs.forEach((t=>{e[t.name]=t.value})),e}close(){super.close(),this._formElement.reset()}showLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitBtn.textContent=e?t:this._submitBtnText}setEventListeners(){this._formElement.addEventListener("submit",(()=>{this._handleFormSubmit(this._getInputValues())})),super.setEventListeners()}}class r{constructor(e,t,s,r,o){this._isLiked=e.isLiked,this._name=e.name,this._link=e.link,this._id=e._id,this._cardSelector=t,this._handleImageClick=s,this._handleDeleteBtn=r,this._handleLikes=o}_setEventListeners(){this._cardElement.querySelector(".card__heart-button").addEventListener("click",(()=>{this._handleLikes(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>this._handleDeleteBtn(this))),this._cardElement.querySelector(".card__image").addEventListener("click",(()=>{this._handleImageClick(this)}))}getId(){const e=this._id;return console.log(e),e}handleDeleteCard(){this._cardElement.remove(),this._cardElement=null}setIsLiked(e){this._isLiked=e,this._renderLikes()}isLiked(){return this._isLiked}toggleLikeButton(){this._cardElement.querySelector(".card__heart-button").classList.toggle("card__heart-button_active")}_renderLikes(){this._isLiked?this._cardElement.querySelector(".card__heart-button").classList.add("card__heart-button_active"):this._cardElement.querySelector(".card__heart-button").classList.remove("card__heart-button_active")}getCardEl(){this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0);const e=this._cardElement.querySelector(".card__image"),t=this._cardElement.querySelector(".card__title");return this._renderLikes(),t.textContent=this._name,e.setAttribute("alt",this._name),e.setAttribute("src",this._link),this._setEventListeners(),this._cardElement}}class o{constructor(e,t){this._formEl=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formInputs=Array.from(this._formEl.querySelectorAll(this._inputSelector)),this._buttonEl=this._formEl.querySelector(this._submitButtonSelector)}_showErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this.errorClass)}_hideErrorMessage(e){const t=this._formEl.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_disableButton(){this._buttonEl.classList.add(this._inactiveButtonClass),this._buttonEl.setAttribute("disabled","")}_enableButton(){this._buttonEl.classList.remove(this._inactiveButtonClass),this._buttonEl.removeAttribute("disabled")}_hasInvalidInputs(){return this._formInputs.some((e=>!e.validity.valid||!e.value))}_checkInputValidity(e){e.validity.valid?this._hideErrorMessage(e):this._showErrorMessage(e)}resetModalValidity(){this._disableButton(),this._formInputs.forEach((e=>{this._hideErrorMessage(e)}))}toggleButtonState(){this._hasInvalidInputs(this._formInputs)?this._disableButton():this._enableButton()}_setEventListeners(){this.toggleButtonState(),this._formInputs.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formEl.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}const n={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_visible"},i=console.log.bind(console),a=document.querySelector("#profile-edit-button"),l=document.querySelector("#profile-edit-modal"),d=document.querySelector(".profile__title"),c=document.querySelector(".profile__description"),h=document.querySelector("#edit_modal-input-name"),_=document.querySelector("#edit-modal-input-desc"),u=l.querySelector(".modal__form"),m=u.querySelector(".modal__button"),p=document.querySelector(".profile__image"),E=document.querySelector(".profile__image_edit-button"),v=document.querySelector(".cards__list"),f=document.querySelector("#card-add-modal"),S=document.querySelector("#card-add-button"),L=f.querySelector(".modal__form"),b=(document.querySelector("#card-delete-confirm-modal").querySelector(".modal__button"),document.querySelector("#update-avatar-modal").querySelector(".modal__form")),y=new class{constructor(e,t,s){this._nameElement=e,this._aboutElement=t,this._avatar=s}getUserInfo(){const e={};return e.name=this._nameElement.textContent,e.about=this._aboutElement.textContent,e}setUserInfo(e,t){this._nameElement.textContent=e,this._aboutElement.textContent=t}setUserAvatar(e){this._avatar.src=e}}(d,c,p),g=new s("#profile-edit-modal",(function(e){y.setUserInfo(e.title,e.description),g.showLoading(!0),i(y.getUserInfo()),U.updateUserInfo(y.getUserInfo()).then((e=>{y.setUserInfo(e.name,e.about),showLoading(!1,m),g.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{g.showLoading(!1)}),1e3)})),g.close()})),k=new s("#update-avatar-modal",(function(e){k.showLoading(!0),U.updateUserAvatar(e).then((e=>{k.close(),y.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{k.showLoading(!1)}),1e3)}))})),C=new s("#card-add-modal",(function(e){C.showLoading(!0);const{title:t,url:s}=e,r={name:t,link:s};U.addNewCard(r).then((e=>{const t=A(e);x.addItem(t),C.close()})).catch((e=>{console.error(`Error ${e}`)})).finally((()=>{setTimeout((()=>{C.showLoading(!1)}),1e3)}))})),I=new class extends t{constructor(e){super(e),this._prevImageCaption=this._modalSelector.querySelector(".modal__preview-image-caption"),this._prevModalImage=this._modalSelector.querySelector(".modal__prev-image")}open(e){this._prevModalImage.src=e._link,this._prevModalImage.alt=e._name,this._prevImageCaption.textContent=e._name,super.open()}}("#image-preview-modal"),q=new class extends t{constructor(e){super(e),this._formElement=this._modalSelector.querySelector(".modal__form")}setSubmitAction(e){this._handleformSubmit=e}setEventListeners(){this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleformSubmit()})),super.setEventListeners()}}("#card-delete-confirm-modal"),w=new o(n,u),B=new o(n,L),$=new o(n,b),U=new class{constructor(e){this._url=e.baseUrl,this._headers=e.headers}intialSetup(e){return Promise.all(e)}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}updateUserAvatar(e){return fetch(`${this._url}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify(e)}).then(this._checkResponse)}loadUserInfo(){return fetch(`${this._url}/users/me`,{headers:this._headers}).then(this._checkResponse)}updateUserInfo(e){return fetch(`${this._url}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then(this._checkResponse)}getInitialCards(){return fetch(`${this._url}/cards`,{headers:this._headers}).then(this._checkResponse)}addNewCard(e){return fetch(`${this._url}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then(this._checkResponse)}deleteCard(e){return fetch(`${this._url}/cards/${e}`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}addCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"PUT",headers:this._headers}).then(this._checkResponse)}removeCardLike(e){return fetch(`${this._url}/cards/${e}/likes`,{method:"DELETE",headers:this._headers}).then(this._checkResponse)}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"e4d91a75-4cb0-43d1-85cd-37dfda4c3b7e","Content-Type":"application/json"}});let x;function A(e){const t=new r(e,"#card-template",M,(function(e){q.open(),q.setSubmitAction((()=>{U.deleteCard(e.getId()).then((()=>{q.close(),e.handleDeleteCard()})).catch((e=>{console.error(`Error ${e}`)}))}))}),(function(e){t.isLiked()?U.removeCardLike(e.getId()).then((e=>{t.setIsLiked(e._isLiked)})).catch((e=>{console.error(`Error ${e}`)})):U.addCardLike(e.getId()).then((e=>{t.setIsLiked(!e._isLiked)})).catch((e=>{console.error(`Error ${e}`)}))}));return t.getCardEl()}function M(e){I.open(e)}U.intialSetup([void U.getInitialCards().then((t=>{x=new e({items:t,renderer:e=>{const t=A(e);x.addItem(t)}},v),x.renderItems(),i(t)})).catch((e=>{console.error(`Error ${e}`)})),void U.loadUserInfo().then((e=>{i(e),y.setUserInfo(e.name,e.about),y.setUserAvatar(e.avatar)})).catch((e=>{console.error(`Error ${e}`)}))]),w.enableValidation(),B.enableValidation(),$.enableValidation(),k.setEventListeners(),g.setEventListeners(),C.setEventListeners(),I.setEventListeners(),q.setEventListeners(),a.addEventListener("click",(()=>{w.resetModalValidity(),h.value=d.textContent,_.value=c.textContent,g.open()})),E.addEventListener("click",(e=>{e.preventDefault(),$.resetModalValidity(),k.open()})),S.addEventListener("click",(e=>{e.preventDefault(),B.resetModalValidity(),C.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE1BNkVuQ3FCLEVBQWtCbkUsbUJBRWxCb0UsRUFBaUJwRSxtQkFFakJxRSxFQUFzQnJFLG1CQUV0QmtELEVBQWtCN0ksb0JBRWxCZ0ksRUFBY2hJLG9CQUVkZ0osRUFBYWhKLG9CQUVic0osRUFBZXRKLG9CQUVmMEosRUFBZ0IxSixvQkFJaEJpRyxFQUFZeEcsaUJBQWlCLFNBQVMsS0FDcENxSyxFQUFrQnJFLHFCQUNsQlksRUFBa0JuRixNQUFRaUYsRUFBVXRGLFlBQ3BDeUYsRUFBa0JwRixNQUFRa0YsRUFBU3ZGLFlBQ25DbUgsRUFBYzFJLE1BQU0sSUFHdEJvSCxFQUFrQmpILGlCQUFpQixTQUFVUSxJQUMzQ0EsRUFBRTJGLGlCQUNGb0UsRUFBc0J2RSxxQkFDdEJvRCxFQUFrQnZKLE1BQU0sSUFJMUJ1SCxFQUFXcEgsaUJBQWlCLFNBQVVRLElBQ3BDQSxFQUFFMkYsaUJBQ0ZtRSxFQUFpQnRFLHFCQUNqQnVELEVBQWExSixNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhEZWxldGUuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBpdGVtQ29udGFpbmVyRWwpIHtcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xuICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG4gICAgdGhpcy5fY29udGFpbmVyID0gaXRlbUNvbnRhaW5lckVsO1xuICB9XG5cbiAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gIH1cblxuICByZW5kZXJJdGVtcygpIHtcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKHRoaXMuX3JlbmRlcmVyKTtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgLy8gdGhpcy5fbW9kYWxTZWxlY3RvciA9IG1vZGFsU2VsZWN0b3I7XG4gICAgdGhpcy5fbW9kYWxTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fbW9kYWxDbG9zZUJ1dHRvbiA9IHRoaXMuX21vZGFsU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX21vZGFsU2VsZWN0b3IuY2xhc3NMaXN0LmFkZChcIm1vZGFsX19vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fbW9kYWxTZWxlY3Rvci5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fbW9kYWxTZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIChlKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICAgKSB7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICB0aGlzLl9tb2RhbENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IobW9kYWxTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCkge1xuICAgIHN1cGVyKG1vZGFsU2VsZWN0b3IpO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSB0aGlzLl9tb2RhbFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fbW9kYWxTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0biA9IHRoaXMuX21vZGFsU2VsZWN0b3IucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ0blRleHQgPSB0aGlzLl9zdWJtaXRCdG4udGV4dENvbnRlbnQ7XG4gIH1cblxuICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcbiAgICB0aGlzLl9mb3JtSW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH0pO1xuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuXG4gIGNsb3NlKCkge1xuICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgfVxuXG4gIHNob3dMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQgPSBcIlNhdmluZy4uLlwiKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnRuLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ0bi50ZXh0Q29udGVudCA9IHRoaXMuX3N1Ym1pdEJ0blRleHQ7XG4gICAgfVxuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENhcmQge1xuICBjb25zdHJ1Y3RvcihcbiAgICBkYXRhLFxuICAgIGNhcmRTZWxlY3RvcixcbiAgICBoYW5kbGVJbWFnZUNsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUJ0bixcbiAgICBoYW5kbGVMaWtlc1xuICApIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX25hbWUgPSBkYXRhLm5hbWU7XG4gICAgdGhpcy5fbGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdG4gPSBoYW5kbGVEZWxldGVCdG47XG4gICAgdGhpcy5faGFuZGxlTGlrZXMgPSBoYW5kbGVMaWtlcztcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvL2NhcmQgXCJsaWtlXCIgYnV0dG9uXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0LWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZUxpa2VzKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICAvL2NhcmQgXCJkZWxldGVcIiBidXR0b25cbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB0aGlzLl9oYW5kbGVEZWxldGVCdG4odGhpcykpO1xuXG4gICAgLy9wcmV2IGltYWdlIGNsaWNrXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpXG4gICAgICAuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgZ2V0SWQoKSB7XG4gICAgY29uc3QgaWQgPSB0aGlzLl9pZDtcbiAgICBjb25zb2xlLmxvZyhpZCk7XG4gICAgcmV0dXJuIGlkO1xuICB9XG5cbiAgaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudC5yZW1vdmUoKTtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IG51bGw7XG4gIH1cblxuICBzZXRJc0xpa2VkKGlzTGlrZWQpIHtcbiAgICB0aGlzLl9pc0xpa2VkID0gaXNMaWtlZDtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICB9XG5cbiAgaXNMaWtlZCgpIHtcbiAgICByZXR1cm4gdGhpcy5faXNMaWtlZDtcbiAgfVxuXG4gIHRvZ2dsZUxpa2VCdXR0b24oKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2hlYXJ0LWJ1dHRvblwiKVxuICAgICAgLmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICB9XG5cbiAgX3JlbmRlckxpa2VzKCkge1xuICAgIGlmICh0aGlzLl9pc0xpa2VkKSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgICAucXVlcnlTZWxlY3RvcihcIi5jYXJkX19oZWFydC1idXR0b25cIilcbiAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19oZWFydC1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGdldENhcmRFbCgpIHtcbiAgICB0aGlzLl9jYXJkRWxlbWVudCA9IGRvY3VtZW50XG4gICAgICAucXVlcnlTZWxlY3Rvcih0aGlzLl9jYXJkU2VsZWN0b3IpXG4gICAgICAuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIilcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgY29uc3QgY2FyZEltYWdlRWwgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIGNvbnN0IGNhcmRUaXRsZUVsID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9yZW5kZXJMaWtlcygpO1xuICAgIGNhcmRUaXRsZUVsLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICBjYXJkSW1hZ2VFbC5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XG4gICAgY2FyZEltYWdlRWwuc2V0QXR0cmlidXRlKFwic3JjXCIsIHRoaXMuX2xpbmspO1xuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWwpIHtcbiAgICB0aGlzLl9mb3JtRWwgPSBmb3JtRWw7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dFNlbGVjdG9yO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICB0aGlzLl9pbnB1dEVycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSB2YWxpZGF0aW9uU2V0dGluZ3MuZXJyb3JDbGFzcztcblxuICAgIHRoaXMuX2Zvcm1JbnB1dHMgPSBBcnJheS5mcm9tKFxuICAgICAgdGhpcy5fZm9ybUVsLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuXG4gICAgdGhpcy5fYnV0dG9uRWwgPSB0aGlzLl9mb3JtRWwucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XG4gIH1cblxuICBfc2hvd0Vycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGZvcm1JbnB1dC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfaGlkZUVycm9yTWVzc2FnZShmb3JtSW5wdXQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm1FbC5xdWVyeVNlbGVjdG9yKGAjJHtmb3JtSW5wdXQuaWR9LWVycm9yYCk7XG4gICAgZm9ybUlucHV0LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgXCJcIik7XG4gIH1cblxuICBfZW5hYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX2J1dHRvbkVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fYnV0dG9uRWwucmVtb3ZlQXR0cmlidXRlKFwiZGlzYWJsZWRcIik7XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0cygpIHtcbiAgICByZXR1cm4gdGhpcy5fZm9ybUlucHV0cy5zb21lKChmb3JtSW5wdXQpID0+IHtcbiAgICAgIHJldHVybiAhZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkIHx8ICFmb3JtSW5wdXQudmFsdWU7XG4gICAgfSk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCkge1xuICAgIGlmICghZm9ybUlucHV0LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93RXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVFcnJvck1lc3NhZ2UoZm9ybUlucHV0KTtcbiAgICB9XG4gIH1cblxuICByZXNldE1vZGFsVmFsaWRpdHkoKSB7XG4gICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICB0aGlzLl9oaWRlRXJyb3JNZXNzYWdlKGZvcm1JbnB1dCk7XG4gICAgfSk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0cyh0aGlzLl9mb3JtSW5wdXRzKSkge1xuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9lbmFibGVCdXR0b24oKTtcbiAgICB9XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy50b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoZm9ybUlucHV0KSA9PiB7XG4gICAgICBmb3JtSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1JbnB1dCk7XG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtRWwuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXQtZXJyb3JfdmlzaWJsZVwiLFxufTtcbiIsImltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhEZWxldGUgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRGVsZXRlLmpzXCI7XG5pbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgeyBGb3JtVmFsaWRhdG9yLCBjb25maWcgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBWYXJpYWJsZXMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNvbnN0IGNsID0gY29uc29sZS5sb2cuYmluZChjb25zb2xlKTtcblxuY29uc3QgcHJvZkVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG5jb25zdCBwcm9mRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtbW9kYWxcIik7XG5jb25zdCBwcm9mVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX3RpdGxlXCIpO1xuY29uc3QgcHJvZkRlc2MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZkVkaXROYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2VkaXRfbW9kYWwtaW5wdXQtbmFtZVwiKTtcbmNvbnN0IHByb2ZFZGl0RGVzY0lucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LW1vZGFsLWlucHV0LWRlc2NcIik7XG5jb25zdCBwcm9mRWRpdEZvcm0gPSBwcm9mRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBwcm9mRWRpdFNhdmVCdG4gPSBwcm9mRWRpdEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgcHJvZkltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZVwiKTtcbmNvbnN0IHByb2ZBdmF0YXJFZGl0QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWFnZV9lZGl0LWJ1dHRvblwiKTtcblxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBjYXJkQWRkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtYWRkLW1vZGFsXCIpO1xuY29uc3QgY2FyZEFkZEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZC1hZGQtYnV0dG9uXCIpO1xuY29uc3QgY2FyZEFkZEZvcm0gPSBjYXJkQWRkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbi8vIGNvbnN0IGNhcmRBZGRTYXZlQnRuID0gY2FyZEFkZEZvcm0ucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuY29uc3QgY2FyZERlbENvbmZpcm1Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2NhcmQtZGVsZXRlLWNvbmZpcm0tbW9kYWxcIlxuKTtcbmNvbnN0IGNhcmREZWxDb25maXJtQnRuID0gY2FyZERlbENvbmZpcm1Nb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG5cbmNvbnN0IHVwZGF0ZUF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiN1cGRhdGUtYXZhdGFyLW1vZGFsXCIpO1xuY29uc3QgdXBkYXRlQXZhdGFyRm9ybSA9IHVwZGF0ZUF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4vLyBjb25zdCB1cGRhdGVBdmF0YXJTYXZlQnRuID0gdXBkYXRlQXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbGFzcyBJbnN0YW5jZXMgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8ocHJvZlRpdGxlLCBwcm9mRGVzYywgcHJvZkltYWdlKTtcblxuY29uc3QgZWRpdFByb2ZNb2RhbCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZkVkaXRTdWJtaXRcbik7XG5cbmNvbnN0IGF2YXRhclVwZGF0ZU1vZGFsID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3VwZGF0ZS1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyVXBkYXRlXG4pO1xuXG5jb25zdCBhZGRDYXJkTW9kYWwgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNjYXJkLWFkZC1tb2RhbFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcblxuY29uc3QgcHJldkltYWdlTW9kYWwgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjaW1hZ2UtcHJldmlldy1tb2RhbFwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gbmV3IFBvcHVwV2l0aERlbGV0ZShcIiNjYXJkLWRlbGV0ZS1jb25maXJtLW1vZGFsXCIpO1xuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgcHJvZkVkaXRGb3JtKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKGNvbmZpZywgY2FyZEFkZEZvcm0pO1xuXG5jb25zdCBhdmF0YXJVcGRhdGVWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihjb25maWcsIHVwZGF0ZUF2YXRhckZvcm0pO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCJlNGQ5MWE3NS00Y2IwLTQzZDEtODVjZC0zN2RmZGE0YzNiN2VcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLyogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQVBJIENhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi9cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbmxldCBzZWN0aW9uO1xuXG5hcGkuaW50aWFsU2V0dXAoW2dldEluaXRhbENhcmRzKCksIGdldEluaXRpYWxJbmZvKCldKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG5mdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBmdW5jdGlvbiBoYW5kbGVEZWxCdG4oY2FyZEluc3RhbmNlKSB7XG4gICAgICBkZWxldGVDYXJkTW9kYWwub3BlbigpO1xuICAgICAgZGVsZXRlQ2FyZE1vZGFsLnNldFN1Ym1pdEFjdGlvbigoKSA9PiB7XG4gICAgICAgIGFwaVxuICAgICAgICAgIC5kZWxldGVDYXJkKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIGRlbGV0ZUNhcmRNb2RhbC5jbG9zZSgpO1xuICAgICAgICAgICAgY2FyZEluc3RhbmNlLmhhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZnVuY3Rpb24gaGFuZGxlTGlrZXMoY2FyZEluc3RhbmNlKSB7XG4gICAgICBpZiAoY2FyZC5pc0xpa2VkKCkpIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLnJlbW92ZUNhcmRMaWtlKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQuc2V0SXNMaWtlZChyZXMuX2lzTGlrZWQpO1xuICAgICAgICAgIH0pXG4gICAgICAgICAgLmNhdGNoKChlcnIpID0+IHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yICR7ZXJyfWApO1xuICAgICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYXBpXG4gICAgICAgICAgLmFkZENhcmRMaWtlKGNhcmRJbnN0YW5jZS5nZXRJZCgpKVxuICAgICAgICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgICAgICAgIGNhcmQuc2V0SXNMaWtlZCghcmVzLl9pc0xpa2VkKTtcbiAgICAgICAgICB9KVxuICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJldHVybiBjYXJkLmdldENhcmRFbCgpO1xufVxuXG5mdW5jdGlvbiBnZXRJbml0YWxDYXJkcygpIHtcbiAgYXBpXG4gICAgLmdldEluaXRpYWxDYXJkcygpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgc2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxuICAgICAgICB7XG4gICAgICAgICAgaXRlbXM6IHJlcyxcbiAgICAgICAgICByZW5kZXJlcjogKGNhcmREYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IHJlbmRlckNhcmQoY2FyZERhdGEpO1xuICAgICAgICAgICAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgICB9LFxuICAgICAgICB9LFxuICAgICAgICBjYXJkTGlzdEVsXG4gICAgICApO1xuICAgICAgc2VjdGlvbi5yZW5kZXJJdGVtcygpO1xuICAgICAgY2wocmVzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gZ2V0SW5pdGlhbEluZm8oKSB7XG4gIGFwaVxuICAgIC5sb2FkVXNlckluZm8oKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIGNsKHJlcyk7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMubmFtZSwgcmVzLmFib3V0KTtcbiAgICAgIHVzZXJJbmZvLnNldFVzZXJBdmF0YXIocmVzLmF2YXRhcik7XG4gICAgfSlcbiAgICAuY2F0Y2goKGVycikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgJHtlcnJ9YCk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcbiAgcHJldkltYWdlTW9kYWwub3BlbihjYXJkRGF0YSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZVByb2ZJbmZvVXBkYXRlKCkge1xuICBlZGl0UHJvZk1vZGFsLnNob3dMb2FkaW5nKHRydWUpO1xuICBjbCh1c2VySW5mby5nZXRVc2VySW5mbygpKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJJbmZvKHVzZXJJbmZvLmdldFVzZXJJbmZvKCkpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzLm5hbWUsIHJlcy5hYm91dCk7XG4gICAgICBzaG93TG9hZGluZyhmYWxzZSwgcHJvZkVkaXRTYXZlQnRuKTtcbiAgICAgIGVkaXRQcm9mTW9kYWwuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBlZGl0UHJvZk1vZGFsLnNob3dMb2FkaW5nKGZhbHNlKTtcbiAgICAgIH0sIDEwMDApO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJVcGRhdGUoaW5wdXRWYWx1ZSkge1xuICBhdmF0YXJVcGRhdGVNb2RhbC5zaG93TG9hZGluZyh0cnVlKTtcbiAgYXBpXG4gICAgLnVwZGF0ZVVzZXJBdmF0YXIoaW5wdXRWYWx1ZSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICBhdmF0YXJVcGRhdGVNb2RhbC5jbG9zZSgpO1xuICAgICAgdXNlckluZm8uc2V0VXNlckF2YXRhcihyZXMuYXZhdGFyKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBhdmF0YXJVcGRhdGVNb2RhbC5zaG93TG9hZGluZyhmYWxzZSk7XG4gICAgICB9LCAxMDAwKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZkVkaXRTdWJtaXQocHJvZmlsZURhdGEpIHtcbiAgdXNlckluZm8uc2V0VXNlckluZm8ocHJvZmlsZURhdGEudGl0bGUsIHByb2ZpbGVEYXRhLmRlc2NyaXB0aW9uKTtcbiAgaGFuZGxlUHJvZkluZm9VcGRhdGUoKTtcbiAgZWRpdFByb2ZNb2RhbC5jbG9zZSgpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGFkZENhcmRNb2RhbC5zaG93TG9hZGluZyh0cnVlKTtcbiAgY29uc3QgeyB0aXRsZSwgdXJsIH0gPSBpbnB1dFZhbHVlcztcbiAgY29uc3QgY2FyZERhdGEgPSB7IG5hbWU6IHRpdGxlLCBsaW5rOiB1cmwgfTtcbiAgYXBpXG4gICAgLmFkZE5ld0NhcmQoY2FyZERhdGEpXG4gICAgLnRoZW4oKGNhcmREYXRhKSA9PiB7XG4gICAgICBjb25zdCBjYXJkID0gcmVuZGVyQ2FyZChjYXJkRGF0YSk7XG4gICAgICBzZWN0aW9uLmFkZEl0ZW0oY2FyZCk7XG4gICAgICBhZGRDYXJkTW9kYWwuY2xvc2UoKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGBFcnJvciAke2Vycn1gKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICBhZGRDYXJkTW9kYWwuc2hvd0xvYWRpbmcoZmFsc2UpO1xuICAgICAgfSwgMTAwMCk7XG4gICAgfSk7XG59XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vKiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBGdW5jdGlvbiBDYWxscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cblxuZWRpdEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYXZhdGFyVXBkYXRlVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuYXZhdGFyVXBkYXRlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZWRpdFByb2ZNb2RhbC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5hZGRDYXJkTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxucHJldkltYWdlTW9kYWwuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZGVsZXRlQ2FyZE1vZGFsLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tIFByb2ZpbGUgQnV0dG9uIExpc3RlbmVycyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbnByb2ZFZGl0QnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIGVkaXRGb3JtVmFsaWRhdG9yLnJlc2V0TW9kYWxWYWxpZGl0eSgpO1xuICBwcm9mRWRpdE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZUaXRsZS50ZXh0Q29udGVudDtcbiAgcHJvZkVkaXREZXNjSW5wdXQudmFsdWUgPSBwcm9mRGVzYy50ZXh0Q29udGVudDtcbiAgZWRpdFByb2ZNb2RhbC5vcGVuKCk7XG59KTtcblxucHJvZkF2YXRhckVkaXRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgYXZhdGFyVXBkYXRlVmFsaWRhdG9yLnJlc2V0TW9kYWxWYWxpZGl0eSgpO1xuICBhdmF0YXJVcGRhdGVNb2RhbC5vcGVuKCk7XG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gQ2FyZCBCdXR0b24gTGlzdGVuZXJzIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbmNhcmRBZGRCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XG4gIGUucHJldmVudERlZmF1bHQoKTtcbiAgYWRkRm9ybVZhbGlkYXRvci5yZXNldE1vZGFsVmFsaWRpdHkoKTtcbiAgYWRkQ2FyZE1vZGFsLm9wZW4oKTtcbn0pO1xuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xuICBjb25zdHJ1Y3RvcihuYW1lRWxlbWVudCwgYWJvdXRFbGVtZW50LCBhdmF0YXIpIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IG5hbWVFbGVtZW50O1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudCA9IGFib3V0RWxlbWVudDtcbiAgICB0aGlzLl9hdmF0YXIgPSBhdmF0YXI7XG4gIH1cblxuICBnZXRVc2VySW5mbygpIHtcbiAgICBjb25zdCB2YWx1ZXMgPSB7fTtcbiAgICB2YWx1ZXMubmFtZSA9IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50O1xuICAgIHZhbHVlcy5hYm91dCA9IHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudDtcbiAgICByZXR1cm4gdmFsdWVzO1xuICB9XG5cbiAgc2V0VXNlckluZm8odGl0bGVEYXRhLCBkZXNjRGF0YSkge1xuICAgIHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50ID0gdGl0bGVEYXRhO1xuICAgIHRoaXMuX2Fib3V0RWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NEYXRhO1xuICB9XG5cbiAgc2V0VXNlckF2YXRhcih1cmwpIHtcbiAgICB0aGlzLl9hdmF0YXIuc3JjID0gdXJsO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKG1vZGFsU2VsZWN0b3IpIHtcbiAgICBzdXBlcihtb2RhbFNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcmV2SW1hZ2VDYXB0aW9uID0gdGhpcy5fbW9kYWxTZWxlY3Rvci5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX3ByZXZpZXctaW1hZ2UtY2FwdGlvblwiXG4gICAgKTtcbiAgICB0aGlzLl9wcmV2TW9kYWxJbWFnZSA9XG4gICAgICB0aGlzLl9tb2RhbFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXYtaW1hZ2VcIik7XG4gIH1cblxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9wcmV2TW9kYWxJbWFnZS5zcmMgPSBkYXRhLl9saW5rO1xuICAgIHRoaXMuX3ByZXZNb2RhbEltYWdlLmFsdCA9IGRhdGEuX25hbWU7XG4gICAgdGhpcy5fcHJldkltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuX25hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRGVsZXRlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihtb2RhbFNlbGVjdG9yKSB7XG4gICAgc3VwZXIobW9kYWxTZWxlY3Rvcik7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9tb2RhbFNlbGVjdG9yLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gIH1cblxuICBzZXRTdWJtaXRBY3Rpb24oZm4pIHtcbiAgICB0aGlzLl9oYW5kbGVmb3JtU3VibWl0ID0gZm47XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlZm9ybVN1Ym1pdCgpO1xuICAgIH0pO1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcbiAgICB0aGlzLl91cmwgPSBvcHRpb25zLmJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycztcbiAgfVxuXG4gIGludGlhbFNldHVwKGZ1bmNBcnIpIHtcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoZnVuY0Fycik7XG4gIH1cblxuICBfY2hlY2tSZXNwb25zZShyZXMpIHtcbiAgICBpZiAocmVzLm9rKSB7XG4gICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICB9XG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICB9XG5cbiAgdXBkYXRlVXNlckF2YXRhcih1cmwpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh1cmwpLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBsb2FkVXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICB1cGRhdGVVc2VySW5mbyhkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgYWJvdXQ6IGRhdGEuYWJvdXQsXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl91cmx9L2NhcmRzYCwge1xuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgYWRkTmV3Q2FyZChkYXRhKSB7XG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX3VybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogZGF0YS5uYW1lLFxuICAgICAgICBsaW5rOiBkYXRhLmxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKHRoaXMuX2NoZWNrUmVzcG9uc2UpO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICBhZGRDYXJkTGlrZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cblxuICByZW1vdmVDYXJkTGlrZShjYXJkSWQpIHtcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fdXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLnRoZW4odGhpcy5fY2hlY2tSZXNwb25zZSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJTZWN0aW9uIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiaXRlbUNvbnRhaW5lckVsIiwiaXRlbXMiLCJyZW5kZXJlciIsInRoaXMiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiYWRkSXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwicmVuZGVySXRlbXMiLCJmb3JFYWNoIiwiUG9wdXAiLCJtb2RhbFNlbGVjdG9yIiwiX21vZGFsU2VsZWN0b3IiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfbW9kYWxDbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY0Nsb3NlIiwiY2xvc2UiLCJyZW1vdmUiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJlIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybUlucHV0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfZm9ybUVsZW1lbnQiLCJfc3VibWl0QnRuIiwiX3N1Ym1pdEJ0blRleHQiLCJ0ZXh0Q29udGVudCIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJyZXNldCIsInNob3dMb2FkaW5nIiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJDYXJkIiwiZGF0YSIsImNhcmRTZWxlY3RvciIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVCdG4iLCJoYW5kbGVMaWtlcyIsIl9pc0xpa2VkIiwiaXNMaWtlZCIsIl9uYW1lIiwiX2xpbmsiLCJsaW5rIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ0biIsIl9oYW5kbGVMaWtlcyIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9jYXJkRWxlbWVudCIsImdldElkIiwiaWQiLCJjb25zb2xlIiwibG9nIiwiaGFuZGxlRGVsZXRlQ2FyZCIsInNldElzTGlrZWQiLCJfcmVuZGVyTGlrZXMiLCJ0b2dnbGVMaWtlQnV0dG9uIiwidG9nZ2xlIiwiZ2V0Q2FyZEVsIiwiY29udGVudCIsImNsb25lTm9kZSIsImNhcmRJbWFnZUVsIiwiY2FyZFRpdGxlRWwiLCJzZXRBdHRyaWJ1dGUiLCJGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybUVsIiwiX2Zvcm1FbCIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIkFycmF5IiwiZnJvbSIsIl9idXR0b25FbCIsIl9zaG93RXJyb3JNZXNzYWdlIiwiZm9ybUlucHV0IiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlRXJyb3JNZXNzYWdlIiwiX2Rpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwicmVtb3ZlQXR0cmlidXRlIiwiX2hhc0ludmFsaWRJbnB1dHMiLCJzb21lIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJyZXNldE1vZGFsVmFsaWRpdHkiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImVuYWJsZVZhbGlkYXRpb24iLCJwcmV2ZW50RGVmYXVsdCIsImNvbmZpZyIsImZvcm1TZWxlY3RvciIsImNsIiwiYmluZCIsInByb2ZFZGl0QnRuIiwicHJvZkVkaXRNb2RhbCIsInByb2ZUaXRsZSIsInByb2ZEZXNjIiwicHJvZkVkaXROYW1lSW5wdXQiLCJwcm9mRWRpdERlc2NJbnB1dCIsInByb2ZFZGl0Rm9ybSIsInByb2ZFZGl0U2F2ZUJ0biIsInByb2ZJbWFnZSIsInByb2ZBdmF0YXJFZGl0QnRuIiwiY2FyZExpc3RFbCIsImNhcmRBZGRNb2RhbCIsImNhcmRBZGRCdG4iLCJjYXJkQWRkRm9ybSIsInVwZGF0ZUF2YXRhckZvcm0iLCJ1c2VySW5mbyIsIm5hbWVFbGVtZW50IiwiYWJvdXRFbGVtZW50IiwiYXZhdGFyIiwiX25hbWVFbGVtZW50IiwiX2Fib3V0RWxlbWVudCIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInZhbHVlcyIsImFib3V0Iiwic2V0VXNlckluZm8iLCJ0aXRsZURhdGEiLCJkZXNjRGF0YSIsInNldFVzZXJBdmF0YXIiLCJ1cmwiLCJzcmMiLCJlZGl0UHJvZk1vZGFsIiwicHJvZmlsZURhdGEiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwiYXBpIiwidXBkYXRlVXNlckluZm8iLCJ0aGVuIiwicmVzIiwiY2F0Y2giLCJlcnIiLCJlcnJvciIsImZpbmFsbHkiLCJzZXRUaW1lb3V0IiwiYXZhdGFyVXBkYXRlTW9kYWwiLCJpbnB1dFZhbHVlIiwidXBkYXRlVXNlckF2YXRhciIsImFkZENhcmRNb2RhbCIsImNhcmREYXRhIiwiYWRkTmV3Q2FyZCIsImNhcmQiLCJyZW5kZXJDYXJkIiwic2VjdGlvbiIsInByZXZJbWFnZU1vZGFsIiwiX3ByZXZJbWFnZUNhcHRpb24iLCJfcHJldk1vZGFsSW1hZ2UiLCJhbHQiLCJkZWxldGVDYXJkTW9kYWwiLCJzZXRTdWJtaXRBY3Rpb24iLCJmbiIsIl9oYW5kbGVmb3JtU3VibWl0IiwiZWRpdEZvcm1WYWxpZGF0b3IiLCJhZGRGb3JtVmFsaWRhdG9yIiwiYXZhdGFyVXBkYXRlVmFsaWRhdG9yIiwib3B0aW9ucyIsIl91cmwiLCJiYXNlVXJsIiwiX2hlYWRlcnMiLCJoZWFkZXJzIiwiaW50aWFsU2V0dXAiLCJmdW5jQXJyIiwiUHJvbWlzZSIsImFsbCIsIl9jaGVja1Jlc3BvbnNlIiwib2siLCJqc29uIiwicmVqZWN0Iiwic3RhdHVzIiwiZmV0Y2giLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImxvYWRVc2VySW5mbyIsImdldEluaXRpYWxDYXJkcyIsImRlbGV0ZUNhcmQiLCJjYXJkSWQiLCJhZGRDYXJkTGlrZSIsInJlbW92ZUNhcmRMaWtlIiwiYXV0aG9yaXphdGlvbiIsImNhcmRJbnN0YW5jZSIsImNhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==